<!DOCTYPE html><html lang=en class="H(100%) Ovy(h)"><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title></title><link rel=stylesheet href=../../../../css/reset.css?1663197779402><link rel=stylesheet href=../../../../css/atomic.css?1663197779402><link rel=stylesheet href=../../../../css/fonts.css?1663197779402><link rel=stylesheet href=../../../../css/site.css?1663197779402><link rel=apple-touch-icon sizes=180x180 href=../../../../img/favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../../../img/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../../../img/favicon/favicon-16x16.png><link rel=manifest href=../../../../img/favicon/manifest.json><link rel=mask-icon href=../../../../img/favicon/safari-pinned-tab.svg color=#5bbad5><link rel="shortcut icon" href=../../../../img/favicon/favicon.ico><meta name=msapplication-config content=../../../../img/favicon/browserconfig.xml><meta name=theme-color content=#ffffff><link rel=license href=../../../../license><script async src="https://www.googletagmanager.com/gtag/js?id=G-H1S197ZSNH"></script><script>window.dataLayer = window.dataLayer || [];
function gtag() { dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'G-H1S197ZSNH');</script></head><body class="H(100%) Ovx(h) Bgc(pageBorderBackground) Bgc(t)--p"><div class="Maw(1002px) H(100%) W(100%) D(f) Fxd(c) Maw(100%)--p Mx(a) Mx(0)--p"><nav class="Bgc(barBackground) Bgc(t)--p Pos(a) Pos(s)--p T(0) Start(0) End(0) Bdbw(1px) Bdc(barBorder) H(50px) C(barText) C(black)--p Px(10px) Z(1)"><div class="W(100%) D(f) H(100%) Jc(sb) Ai(c) Ov(h)"><div class="D(f) Whs(nw) Ai(c) Fxs(1) Ov(h) Pend(12px)"><a class="C(barText) C(black)--p Fz(1.4em) Fw(b) Tov(e) Ov(h) Fxs(1) Td(n)--p Tov(e) D(b)" href=../../../../ >Rumkin.com </a><span class="Px(0.3em) Fxs(0)">&gt;</span> <a class="C(barText) C(black)--p Fz(1.4em) Fw(b) Tov(e) Ov(h) Fxs(1) Td(n)--p Tov(e) D(b)" href=../../../ >Programming Topics </a><span class="Px(0.3em) Fxs(0)">&gt;</span> <a class="C(barText) C(black)--p Fz(1.4em) Fw(b) Tov(e) Ov(h) Fxs(1) Td(n)--p Tov(e) D(b)" href=../../ >Algorithms </a><span class="Px(0.3em) Fxs(0)">&gt;</span> <a class="C(barText) C(black)--p Fz(1.4em) Fw(b) Tov(e) Ov(h) Fxs(0) Td(n)--p Tov(e) D(b)" href=../ >Fuzzy String Matching</a></div></div></nav><div class="Bgc(pageBackground) Bgc(t)--p Fxg(1)"><div class="Mt(50px) Mt(0)--p C(textColorNormal) P(10px)"><div class="Mx(a) W(100%) Maw(contentWidthMax) Maw(100%)--p D(f) Px(10px) Pstart(0)"><main class="D(tbc) Va(t) W(100%)"><header><h1></h1></header><div class=contents><hr><h2 id=title-levenshtein-distance-algorithm-tsql-implementation>title: Levenshtein Distance Algorithm: TSQL Implementation</h2><p>by Joseph Gama</p><pre><code>CREATE function LEVENSHTEIN( @s varchar(50), @t
varchar(50) )
--Returns the Levenshtein Distance between strings s1
and s2.
--Original developer: Michael Gilleland
http://www.merriampark.com/ld.htm
--Translated to TSQL by Joseph Gama
returns varchar(50)
as
BEGIN
DECLARE @d varchar(100), @LD int, @m int, @n int, @i
int, @j int,
@s_i char(1), @t_j char(1),@cost int
--Step 1
SET @n=LEN(@s)
SET @m=LEN(@t)
SET @d=replicate(CHAR(0),100)
If @n = 0
    BEGIN
    SET @LD = @m
    GOTO done
    END
If @m = 0
    BEGIN
    SET @LD = @n
    GOTO done
    END
--Step 2
SET @i=0
WHILE @i&lt;=@n
    BEGIN
    SET @d=STUFF(@d,@i+1,1,CHAR(@i))--d(i, 0) = i
    SET @i=@i+1
    END

SET @i=0
WHILE @i&lt;=@m
    BEGIN
    SET @d=STUFF(@d,@i*(@n+1)+1,1,CHAR(@i))--d(0, j) = j
    SET @i=@i+1
    END
--goto done
--Step 3
    SET @i=1
    WHILE @i&lt;=@n
        BEGIN
        SET @s_i=(substring(@s,@i,1))
--Step 4
    SET @j=1
    WHILE @j&lt;=@m
        BEGIN
        SET @t_j=(substring(@t,@j,1))
        --Step 5
        If @s_i = @t_j
            SET @cost=0
        ELSE
            SET @cost=1
--Step 6
        SET @d=STUFF(@d,@j*(@n+1)+@i+1,1,CHAR(dbo.MIN3(
        ASCII(substring(@d,@j*(@n+1)+@i-1+1,1))+1,
        ASCII(substring(@d,(@j-1)*(@n+1)+@i+1,1))+1,
        ASCII(substring(@d,(@j-1)*(@n+1)+@i-1+1,1))+@cost)
        ))
        SET @j=@j+1
        END
    SET @i=@i+1
    END
--Step 7
SET @LD = ASCII(substring(@d,@n*(@m+1)+@m+1,1))
done:
--RETURN @LD
--I kept this code that can be used to display the
matrix with all calculated values
--From Query Analyser it provides a nice way to check
the algorithm in action
--
RETURN @LD
--declare @z varchar(255)
--set @z=&#39;&#39;
--SET @i=0
--WHILE @i&lt;=@n
--    BEGIN
--    SET @j=0
--    WHILE @j&lt;=@m
--        BEGIN
--        set
@z=@z+CONVERT(char(3),ASCII(substring(@d,@i*(@m+1
)+@j+1 ,1)))
--        SET @j=@j+1
--        END
--    SET @i=@i+1
--    END
--print dbo.wrap(@z,3*(@n+1))
END
</code></pre></div></main></div></div></div><footer class="Bgc(barBackground) Bgc(t)--p Bdtw(1px) Bdc(barBorder) C(barText) C(black)--p P(10px) D(f) Fxd(c)--p Jc(sb)"><div class=Fz(0.8em)>&copy; Copyright 2022 Tyler Akins &lt;<a class="Td(n)--p C(barText) C(black)--p" href=mailto:fidian@rumkin.com>fidian@rumkin.com</a>&gt;, last build 2022-09-14T23:22:59.402Z</div><div><a class="D(n)--p Fz(0.8em) C(barText)" href=../../../../license/ >License</a> | <a class="D(n)--p Fz(0.8em) C(barText)" href=../../../../reference/site/legal/ >Legal</a> <a class="D(n) D(b)--p Td(n) Fz(0.8em)" href=../../../../license/ >Site content licensed under a MIT license with a non-advertising clause</a></div></footer></div></body></html>