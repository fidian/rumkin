<!DOCTYPE html><html lang=en class="H(100%) Ovy(h)"><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Palm OS Programming - Gotchyas</title><link rel=stylesheet href=../../../css/reset.css?1666620457971><link rel=stylesheet href=../../../css/atomic.css?1666620457971><link rel=stylesheet href=../../../css/fonts.css?1666620457971><link rel=stylesheet href=../../../css/site.css?1666620457971><link rel=apple-touch-icon sizes=180x180 href=../../../img/favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../../img/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../../img/favicon/favicon-16x16.png><link rel=manifest href=../../../img/favicon/manifest.json><link rel=mask-icon href=../../../img/favicon/safari-pinned-tab.svg color=#5bbad5><link rel="shortcut icon" href=../../../img/favicon/favicon.ico><meta name=msapplication-config content=../../../img/favicon/browserconfig.xml><meta name=theme-color content=#ffffff><link rel=license href=../../../license><script async src="https://www.googletagmanager.com/gtag/js?id=G-H1S197ZSNH"></script><script>window.dataLayer = window.dataLayer || [];
function gtag() { dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'G-H1S197ZSNH');</script></head><body class="H(100%) Ovx(h) Bgc(pageBorderBackground) Bgc(t)--p"><div class="Maw(1002px) H(100%) W(100%) D(f) Fxd(c) Maw(100%)--p Mx(a) Mx(0)--p"><nav class="Bgc(barBackground) Bgc(t)--p Pos(a) Pos(s)--p T(0) Start(0) End(0) Bdbw(1px) Bdc(barBorder) H(50px) C(barText) C(black)--p Px(10px) Z(1)"><div class="W(100%) D(f) H(100%) Jc(sb) Ai(c) Ov(h)"><div class="D(f) Whs(nw) Ai(c) Fxs(1) Ov(h) Pend(12px)"><a class="C(barText) C(black)--p Fz(1.4em) Fw(b) Tov(e) Ov(h) Fxs(1) Td(n)--p Tov(e) D(b)" href=../../../ >Rumkin.com </a><span class="Px(0.3em) Fxs(0)">&gt;</span> <a class="C(barText) C(black)--p Fz(1.4em) Fw(b) Tov(e) Ov(h) Fxs(1) Td(n)--p Tov(e) D(b)" href=../../ >Programming Topics </a><span class="Px(0.3em) Fxs(0)">&gt;</span> <a class="C(barText) C(black)--p Fz(1.4em) Fw(b) Tov(e) Ov(h) Fxs(0) Td(n)--p Tov(e) D(b)" href=../ >Palm OS Programming</a></div></div></nav><div class="Bgc(pageBackground) Bgc(t)--p Fxg(1)"><div class="Mt(50px) Mt(0)--p C(textColorNormal) P(10px)"><div class="Mx(a) W(100%) Maw(contentWidthMax) Maw(100%)--p D(f) Px(10px) Pstart(0)"><main class="D(tbc) Va(t) W(100%)"><header><h1>Palm OS Programming - Gotchyas</h1></header><div class=contents><p>This is the text, extracted from a presentation for Palm OS Programming Gotchyas and Pitfalls. I don&#39;t use Adobe and I wanted a textual reference instead of printing out slides, so I did this.</p><h2 id=confusing-form-object-ids-with-object-index>Confusing Form Object IDs with Object Index</h2><pre><code>pBtn = FrmGetObjectPtr(MainOKButton);
</code></pre><ul><li>Most Form Manager routines need object index</li><li>Compiler can&#39;t catch: both are type <code>UInt16</code></li><li>Typical error messages:<ul><li>Object not found in form</li><li>Index out of range</li></ul></li><li>Solution: check API parameters carefully and use <code>FrmGetObjectIndex()</code></li></ul><h2 id=correct-id-wrong-resource>Correct ID, Wrong Resource</h2><pre><code>pLogo = DmGetResource(bitmapRsc, 10004);
</code></pre><ul><li>If <code>DmGetResource()</code> can&#39;t find match in the last opened resource database, continues search through resource chain</li><li>Solution<ul><li>Use Console opened command to display the resource chain</li><li>Don&#39;t use resource IDs &lt;= 128 or &gt;= 10000</li><li>Use <code>DmGet1Resource()</code></li></ul></li></ul><h2 id=apps-must-use-appl-as-database-type>Apps Must Use <code>appl</code> as Database Type</h2><ul><li>Runs when you debug, but does not show up in Launcher</li><li>Launcher only displays icons for resource databases of type <code>appl</code></li><li>App built with a different type can run, but must be launched via code</li><li>Set in PalmRez post linker panel</li></ul><h2 id=popup-lists>Popup Lists</h2><ul><li>Assign list object ID to trigger</li><li>Check for <code>popSelectEvent</code></li><li>Override default behavior of <code>popSelectEvent</code> if list items are not defined<ul><li>In resources</li><li>By using <code>LstSetListItems()</code></li></ul></li><li>Return true from event handler</li></ul><h2 id=frmcopytitle--frmcopylabel><code>FrmCopyTitle</code> &amp; <code>FrmCopyLabel</code></h2><ul><li>These calls copy a string to a buffer</li><li>Buffer size is determined by size of label or title defined in resources</li><li>Solution 1: Make placeholder label/title &quot;big enough&quot; to hold anticipated strings</li><li>Solution 2: Use <code>FrmSetTitle()</code> for forms</li><li>Solution 3: Use text fields instead of labels if you need to change at runtime</li></ul><h2 id=common-cc-problems>Common C/C++ Problems</h2><ul><li><p>Learn C before learning Palm OS APIs</p></li><li><p>Pointers and data type promotion</p></li><li><p>Example</p><pre><code>  Char *p;
  StrCopy(p, &quot;Ooops&quot;);
  P = MemPtrNew(60 * 1024);
</code></pre></li></ul><h2 id=standard-c-libraries-vs-palm-os-apis>Standard C Libraries vs. Palm OS APIs</h2><ul><li>Use String and Memory Managers<ul><li>Smaller app footprint</li><li>Support for multibyte character sets</li></ul></li><li>However, check API parameters carefully<ul><li><code>StrPrintF</code> is almost the same as <code>sprintf</code></li><li><code>MemSet</code> parameters switched from <code>memset</code></li></ul></li><li>Exception handling<ul><li>Use Error Manager instead of C++ exceptions</li><li><code>ErrTry</code>, <code>ErrCatch</code>, etc.</li></ul></li></ul><h2 id=form-drawing>Form Drawing</h2><ul><li>Call <code>FrmDrawForm</code> before drawing on form<ul><li>Problems with modal dialogs and &quot;save behind&quot; bit</li><li>Debug ROMs will catch</li><li>Can use <code>WinScreenLock</code> to improve performance</li></ul></li><li>Beware functions that draw immediately<ul><li><code>FldDrawField</code>, <code>LstDrawList</code>, etc.</li></ul></li></ul><h2 id=form-updating>Form Updating</h2><ul><li>Default <code>frmUpdateEvent</code> calls <code>FrmDrawForm()</code><ul><li>Erases form</li><li>Draws form border</li><li>Draws form objects</li><li>But not old-style gadgets</li></ul></li><li>Custom drawing not updated unless you handle the event yourself</li><li>Use extended gadgets to automate</li><li>If you do handle <code>frmUpdateEvent</code> return true to stop system from handling it after you</li></ul><h2 id=text-fields>Text Fields</h2><ul><li>Don&#39;t use <code>FldGrabFocus()</code><ul><li>Use <code>FrmSetFocus()</code></li><li>Call <code>FrmSetFocus()</code> after <code>FrmDrawForm()</code></li></ul></li><li>Use <code>PrvSetFieldText()</code> from NetSample sample project<ul><li>Does all the right things</li><li>Avoids all the standard difficulties</li><li>Supports immediate/delayed update and appending</li></ul></li></ul><h2 id=database-names-and-creator-codes>Database Names and Creator Codes</h2><ul><li>Creator codes should be unique<ul><li>Benefits your customers if unique</li><li>Automates clean-up of device when deleting</li><li>Register code before coding starts</li></ul></li><li>Database names must be unique<ul><li>Remember, apps are databases also</li><li>Use form &quot;AppName-Code&quot;</li></ul></li></ul><h2 id=palm-os-data-structure-access>Palm OS Data Structure Access</h2><ul><li><p>Don&#39;t access UI data structure fields directly</p></li><li><p>Use accessor functions</p><ul><li><code>FrmGetFormId()</code>, <code>LstGetSelection()</code>, etc.</li><li>New accessors in SDK 4.0 Update 1</li></ul></li><li><p>Good way to prepare for Palm OS® Version 5</p></li><li><p>Palm OS Emulator reports (non-fatal error)</p></li><li><p>Catch in compiler</p><pre><code>  #define DO_NOT_ALLOW_ACCESS_TO_INTERNALS_OF_STRUCTS
  #include &lt;PalmOS.h&gt;
</code></pre></li></ul><h2 id=database-searching>Database Searching</h2><ul><li><code>DmFindSortPosition()</code><ul><li>Design: maintain sort order when adding records</li><li>Returns index after any matching records</li></ul></li><li>When used to find records:<ul><li>If index &gt; 0, compare previous record</li><li>If record matches, you found search target</li><li>If record does not match, search target is not in database</li></ul></li></ul><h2 id=global-variables>Global Variables</h2><ul><li>Not accessible if app is not active<ul><li>Find, receive beam, alarms, etc.</li></ul></li><li>Global data not always obvious<ul><li>String constants</li><li>Smart code model intra-segment jumps</li><li>Access at end of long function call chain</li></ul></li><li>Use <code>#pragma warn_a5_access on</code></li><li>Use &quot;PC-Relative strings&quot; options</li></ul><h2 id=error-avoidance>Error Avoidance</h2><ul><li>Require function prototypes</li><li>Turn on all warnings and errors</li><li>Use <code>DO_NOT_ALLOW_ACCESS_TO_INTERNALS_OF_STRUCTS</code></li><li>Use assertions</li><li>Use POSE and debug ROMs</li></ul><h2 id=pose-and-debug-roms>POSE and Debug ROMs</h2><ul><li>Palm OS Emulator will catch numerous errors<ul><li>Memory leaks, data structure access, stack overflow, low memory access, ...</li><li>Gremlins and new minimize feature automate the hunt</li></ul></li><li>Debug ROMs check for invalid parameters<ul><li>Range checking, forced update events, etc.</li></ul></li><li>Always use the latest POSE build</li><li>Test using ROMs for minimum and latest versions of Palm OS</li></ul><h2 id=suggestions>Suggestions</h2><ul><li>Palm OS® Essentials course<ul><li>Lots of lab time</li><li>Developer instructors</li><li>Terrific sample applications with source</li></ul></li><li>Palm OS Recipes<ul><li>Step-by-step solutions to common problems</li></ul></li><li>Sample code<ul><li>Use CodeWarrior Find feature, grep, etc.</li></ul></li><li>Third-party books</li></ul></div></main></div></div></div><footer class="Bgc(barBackground) Bgc(t)--p Bdtw(1px) Bdc(barBorder) C(barText) C(black)--p P(10px) D(f) Fxd(c)--p Jc(sb)"><div class=Fz(0.8em)>&copy; Copyright 2022 Tyler Akins &lt;<a class="Td(n)--p C(barText) C(black)--p" href=mailto:fidian@rumkin.com>fidian@rumkin.com</a>&gt;, last build 2022-10-24T14:07:37.971Z</div><div><a class="D(n)--p Fz(0.8em) C(barText)" href=../../../license/ >License</a> | <a class="D(n)--p Fz(0.8em) C(barText)" href=../../../reference/site/legal/ >Legal</a> <a class="D(n) D(b)--p Td(n) Fz(0.8em)" href=../../../license/ >Site content licensed under a MIT license with a non-advertising clause</a></div></footer></div></body></html>