<!DOCTYPE html><html lang=en class="H(100%) Ovy(h)"><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>One Time Pad XOR</title><script src=../../js/acss-live.js></script><link rel=stylesheet href=../../css/reset.css?1717014395529><link rel=stylesheet href=../../css/fonts.css?1717014395529><link rel=stylesheet href=../../css/site.css?1717014395529><link rel=apple-touch-icon sizes=180x180 href=../../img/favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../img/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../img/favicon/favicon-16x16.png><link rel=manifest href=../../img/favicon/manifest.json><link rel=mask-icon href=../../img/favicon/safari-pinned-tab.svg color=#5bbad5><link rel="shortcut icon" href=../../img/favicon/favicon.ico><meta name=msapplication-config content=../../img/favicon/browserconfig.xml><meta name=theme-color content=#ffffff><link rel=license href=../../license><script async src="https://www.googletagmanager.com/gtag/js?id=G-H1S197ZSNH"></script><script>window.dataLayer = window.dataLayer || [];
function gtag() { dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'G-H1S197ZSNH');</script></head><body class="H(100%) Ovx(h) Bgc(pageBorderBackground) Bgc(tr)--p"><div class="Maw(1002px) H(100%) W(100%) D(f) Fxd(c) Maw(100%)--p Mx(a) Mx(0)--p"><nav class="Bgc(barBackground) Bgc(tr)--p Pos(a) Pos(s)--p T(0) Start(0) End(0) Bdbw(1px) Bdc(barBorder) H(50px) C(barText) C(black)--p Px(10px) Z(1)"><div class="W(100%) D(f) H(100%) Jc(spb) Ai(c) Ov(h)"><div class="D(f) Whs(nw) Ai(c) Fxs(1) Ov(h) Pend(12px)"><a class="C(barText) C(black)--p Fz(1.4em) Fw(b) Tov(e) Ov(h) Fxs(1) Td(n)--p Tov(e) D(b)" href=../../ >Rumkin.com </a><span class="Px(0.3em) Fxs(0)">&gt;</span> <a class="C(barText) C(black)--p Fz(1.4em) Fw(b) Tov(e) Ov(h) Fxs(0) Td(n)--p Tov(e) D(b)" href=../ >Software Projects</a></div></div></nav><div class="Bgc(pageBackground) Bgc(tr)--p Fxg(1)"><div class="Mt(50px) Mt(0)--p C(textColorNormal) P(10px)"><div class="Mx(a) W(100%) Maw(contentWidthMax) Maw(100%)--p D(f) Px(10px) Pstart(0)"><main class="D(tbc) Va(t) W(100%)"><header><h1>One Time Pad XOR</h1><div class=Px(20px)><div class="Bgc(#c5e0f9) Bgc(tr)--p Fs(i) Py(4px) Px(8px)">Encrypt a file with a one-time pad, which is the only unbreakable cipher in existence.</div></div></header><div class=contents><p>Need a secure method to encrypt files? Want it to be quick, easy, and unbreakable as long as you take care with it? This is the tool for you! For information on the technique and the tools, I suggest you go to <a href=http://www.aspheute.com/english/20010924.asp>Unbreakable Encryption Using One Time Pads</a>.</p><p>The tools I have here are modeled after the ones designed there, but mine work in DOS and don&#39;t require .NET. If you have .NET, I suggest <em>not</em> using my tools and using Unbreakable&#39;s instead. At least use Unbreakable&#39;s <code>padgen</code> program because I&#39;m pretty sure it generates better random numbers than mine does.</p><p>These tools also work on Linux, for people like me.</p><h2 id=generating-a-one-time-pad>Generating a One Time Pad</h2><p>Just like on the Unbreakable site, you use the following syntax:</p><pre><code>padgen padfilename padfilesize
</code></pre><p>Instead of using the random number generator and instead of compiling your own program, you can generate a pad file from input files. Good candidates for random data from input files are compressed archives, video and audio files, large images, executable programs, and other binary sources of data. However, you can use text files if you want, but it is not suggested.</p><p>To generate a random pad by merging input files, use the <code>padfile</code> program:</p><pre><code>padfile padfilename inputfile1 [inputfile2 [...]]
</code></pre><p>You don&#39;t need to specify more than one input file, but you are allowed to (do not have the [ and ] symbols around your file names). <code>padfile</code> will generate a pad file that is just a bit smaller than half the size of the input files. Plan accordingly. It is good to have a pad file be bigger than the file you wish to encrypt, but not 100% necessary for these tools.</p><h2 id=encrypting-and-decrypting>Encrypting and Decrypting</h2><p>This tool is similar to the one on the <a href=http://www.aspheute.com/english/20010924.asp>Unbreakable site</a>, but I decided to make a few parameters for it.</p><pre><code>padxor [options] inputfile padfile outputfile
</code></pre><p>Options:</p><ul><li><p><code>-s byte</code> - This will start using the padfile at the specified byte. This is good if you send a large padfile to someone, then you want to send tiny encrypted files back and forth. You can use a section of the padfile for each file you send.</p></li><li><p><code>-l</code> - Loop the padfile when you use it up. Normally, the <code>padxor</code> program will stop running if you run out of bytes during encoding. Looping will let you use a 1 meg file to encrypt a 10 meg file, but doing that is bad for security. If you are ultra-paranoid, don&#39;t use this. If you are just trying to hide a large file from prying eyes (parents, coworkers, children), then you can stick your key on some sort of removable media and encrypt the files with a smaller key and just keep looping through it.</p></li><li><p><code>-b</code> - Prints out what was the last byte used in the encryption/decryption. For the totally paranoid, you would then use <code>-s</code> to start at the last byte used + 1.</p></li><li><p><code>-r</code> - Start at a random byte in a padfile. See the &quot;Funky Ideas&quot; section below.</p></li><li><p><code>-x num</code> - Encrypt the result yet again with another static XOR. See the &quot;Funky Ideas&quot; section below. The value you pass in must be between 0 and 255.</p></li><li><p><code>-i</code> - Change the <code>-x</code> value every time you loop through the key file. See the &quot;Funky Ideas&quot; section below.</p></li></ul><h2 id=examples>Examples</h2><p>This example is designed to be just like the one on <a href=http://www.aspheute.com/english/20010924.asp>Unbreakable</a>, but for my tools. First we generate a pad file. Next we use it to encode a file and finally decode the encoded file.</p><pre><code>padgen mypad.bin 200000
padxor otp.cs mypad.bin otp.cs.enc
padxor otp.cs.enc mypad.bin otp.cs.dec
</code></pre><p>Or, if you wanted to use a large pre-generated key, start in the middle of the file, and get the byte that it last used in the encoded file, use something like:</p><pre><code>padxor -s 12047 -b otp.cs mypad.bin otp.cs.enc
padxor -s 12047 -b otp.cs mypad.bin otp.cs.enc
</code></pre><h2 id=secure-deletion-of-the-one-time-pad>Secure Deletion of the One Time Pad</h2><p>The <code>wipe</code> tool just writes random-ish data over and over and over and over on the file. This may not work, depending on the file system. Some file systems are journaled, so the old data is not actually overwritten on the disk. However, for DOS, this would work fine.</p><pre><code>wipe some_file.bin
</code></pre><h2 id=alternate-pad-generation>Alternate Pad Generation</h2><p>Since <code>padgen</code> uses the <code>rand()</code> function, and that has been proven to be a bad source for random data, you might want to edit the program and use a different random number generator. If you use .NET, I would suggest the <code>padgen</code> program from <a href=http://www.aspheute.com/english/20010924.asp>Unbreakable&#39;s site</a>. If you don&#39;t, there are many other ways to get a random one time pad, such as the program that is on the One Time Pad site (see the Links section).</p><p>If using Linux, you can just use <code>dd</code> to create a 1 MB file (1024 bytes per read * 1024 reads) like the next example. It reads from <code>/dev/urandom</code>, which is as secure of a random number generator as one will easily find.</p><pre><code>dd if=/dev/urandom of=mypad.bin bs=1024 count=1024
</code></pre><p>There are other tools and web sites that will give you statistically random data. To make sure that you feel safe using your key file, you can use the <code>padtest</code> program to see how random the data is. The guts of this program are actually from the One Time Pad program (see the Links section). It only includes the statistical testing that the <code>otp.c</code> program contains and not the rest of the stuff.</p><pre><code>padtest mypad.bin
</code></pre><p>Keep in mind that no program can ever verify that data is random. It can just test certain things that indicate non-randomness. Also, the tests in <code>padtest</code> are not the best because they are just quick little tests. A better tester is <a href=http://www.fourmilab.ch/random/ ><code>ent</code></a>, available in the Links section.</p><p>If you don&#39;t decide to change the random number generation function from <code>rand()</code> in <code>padgen</code>, you could be vulnerable. If a person uses special tools designed to find your key, you are in trouble. If the cracker can figure out the first four bytes of the key from the file header, the <code>srand</code> seed can be found with <a href=findpad.zip><code>findpad</code></a>. Then, if you know the length of the key file, <code>padseed</code> will make a pad with your specified seed. Not good for security, but good for simple security that you can recover.</p><p><code>padfile</code> is a much better solution than <code>padgen</code>. Heck, generate hundreds of pad files and just <code>padxor</code> them together to create one good pad file. If you XOR two random data sources, the result will be random data that is as good as the best source. So, if you have many different programs generate pad files for you and you XOR them together, the strength of the resulting file will be as strong, bit for bit, as the best source of data.</p><h2 id=funky-ideas>Funky Ideas</h2><p>First, a disclaimer: this is <strong>not</strong> good security. These things were implemented to make retrieval of the data by a random visitor impossible, but the NSA would laugh at what we do here.</p><p>There is a situation where we need a zip file encoded with a key. The key is unable to be changed, and will be smaller than the zip file, thus we need to use <code>-l</code> to loop through the key file. This works just fine to keep it out of casual view and would give any hacker problems due to the size of the key file and that we are trying to decode a zip file.</p><p>However, if the key was leaked, it would be trivial to decode the zip archive, so by using <code>-r</code>, it is made a bit harder. The zip file now is encrypted with the key, but in one of a million starting points. This would probably give the hacker a hassle for a bit. The downside (and the part that makes recovery of the zip file with the key possible) is that zip files have a 4-byte &quot;header&quot; at the beginning of the file. The hacker could just decrypt the 4-byte header with each of the million starting places, note the ones that have the correct header, and manually test those. So, the number of possible starting places in the key is limited down to maybe 10 in a few seconds of decoding.</p><p>So, now by using the <code>-x</code> and maybe <code>-i</code> options, and by using a random number for <code>-x</code> (not coded into <code>padxor</code>), any spot in the file could now be a potential starting point. The hacker would need to generate the <code>-x</code> and try that versus the next three bytes. Eventually, the person would get 30-50 potential starting points with <code>-x</code> keys, and will be able to hack their way into the file again.</p><p>Because security through obscurity is not real security, we decided that the <code>-x</code>, <code>-i</code>, and <code>-r</code> options wouldn&#39;t be that useful for our purposes. Thus, development was stopped with them, but I left them in the program just in case you wanted to use them.</p><h2 id=download>Download</h2><p><a href=padxor.zip>padxor.zip</a> - Source code that compiles on several platforms. Also includes DOS executables. <a href=findpad.zip>findpad.zip</a> - Tool to try to decode files when a <code>rand()</code> generator was used.</p><h2 id=links>Links</h2><ul><li><a href=http://www.aspheute.com/english/20010924.asp>Unbreakable Encryption Using One Time Pads</a> - What these tools were based on.</li><li>One Time Pad Encryption (<a href=http://www.vidwest.com/otp/index.htm>http://www.vidwest.com/otp/index.htm</a> - link is dead) - The source for <code>padtest</code>&#39;s random number tests.</li><li><a href=http://www.fourmilab.ch/hotbits/ >Hotbits</a> - A source for random data.</li><li><a href=http://www.random.org/ >Random.org</a> - Another source for random data.</li><li><a href=http://www.fourmilab.ch/random/ >Pseudorandom Number Sequence Test Program</a> - Home of &quot;ent&quot; tool.</li></ul></div></main></div></div></div><footer class="Bgc(barBackground) Bgc(tr)--p Bdtw(1px) Bdc(barBorder) C(barText) C(black)--p P(10px) D(f) Fxd(c)--p Jc(spb)"><div class=Fz(0.8em)>&copy; Copyright 2024 Tyler Akins &lt;<a class="Td(n)--p C(barText) C(black)--p" href=mailto:fidian@rumkin.com>fidian@rumkin.com</a>&gt;, last build 2024-05-29T20:26:35.529Z</div><div><a class="D(n)--p Fz(0.8em) C(barText)" href=../../license/ >License</a> | <a class="D(n)--p Fz(0.8em) C(barText)" href=../../reference/site/legal/ >Legal</a> <a class="D(n) D(b)--p Td(n) Fz(0.8em)" href=../../license/ >Site content licensed under a MIT license with a non-advertising clause</a></div></footer></div></body></html>