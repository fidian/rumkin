<!DOCTYPE html><html lang=en class="H(100%) Ovy(h)"><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Query Analyzer to Excel</title><script src=../../js/acss-live.js></script><link rel=stylesheet href=../../css/reset.css?1678497115282><link rel=stylesheet href=../../css/fonts.css?1678497115282><link rel=stylesheet href=../../css/site.css?1678497115282><link rel=apple-touch-icon sizes=180x180 href=../../img/favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../img/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../img/favicon/favicon-16x16.png><link rel=manifest href=../../img/favicon/manifest.json><link rel=mask-icon href=../../img/favicon/safari-pinned-tab.svg color=#5bbad5><link rel="shortcut icon" href=../../img/favicon/favicon.ico><meta name=msapplication-config content=../../img/favicon/browserconfig.xml><meta name=theme-color content=#ffffff><link rel=license href=../../license><script async src="https://www.googletagmanager.com/gtag/js?id=G-H1S197ZSNH"></script><script>window.dataLayer = window.dataLayer || [];
function gtag() { dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'G-H1S197ZSNH');</script></head><body class="H(100%) Ovx(h) Bgc(pageBorderBackground) Bgc(tr)--p"><div class="Maw(1002px) H(100%) W(100%) D(f) Fxd(c) Maw(100%)--p Mx(a) Mx(0)--p"><nav class="Bgc(barBackground) Bgc(tr)--p Pos(a) Pos(s)--p T(0) Start(0) End(0) Bdbw(1px) Bdc(barBorder) H(50px) C(barText) C(black)--p Px(10px) Z(1)"><div class="W(100%) D(f) H(100%) Jc(spb) Ai(c) Ov(h)"><div class="D(f) Whs(nw) Ai(c) Fxs(1) Ov(h) Pend(12px)"><a class="C(barText) C(black)--p Fz(1.4em) Fw(b) Tov(e) Ov(h) Fxs(1) Td(n)--p Tov(e) D(b)" href=../../ >Rumkin.com </a><span class="Px(0.3em) Fxs(0)">&gt;</span> <a class="C(barText) C(black)--p Fz(1.4em) Fw(b) Tov(e) Ov(h) Fxs(0) Td(n)--p Tov(e) D(b)" href=../ >Problems Only Tyler Has</a></div></div></nav><div class="Bgc(pageBackground) Bgc(tr)--p Fxg(1)"><div class="Mt(50px) Mt(0)--p C(textColorNormal) P(10px)"><div class="Mx(a) W(100%) Maw(contentWidthMax) Maw(100%)--p D(f) Px(10px) Pstart(0)"><main class="D(tbc) Va(t) W(100%)"><header><h1>Query Analyzer to Excel</h1><div class=Px(20px)><div class="Bgc(#c5e0f9) Bgc(tr)--p Fs(i) Py(4px) Px(8px)">Exporting results from Microsoft SQL Server's Query Analyzer, including the column headers.</div></div></header><div class=contents><p>Microsoft SQL Server&#39;s Query Analyzer is great. I&#39;d also like to export the results as a file that I can load into Excel and analyze further or hand off to other people. That, apparently, was not readily supported because when you copy and paste the results to Excel, the column headers are missing.</p><h2 id=symptoms>Symptoms</h2><p>You are running Microsoft SQL Server&#39;s Query Analyzer and you want to copy your results grid to Excel. Copying the grid and pasting it in Excel does not work well because you are missing column headings.</p><h2 id=causes>Causes</h2><p>Well, it&#39;s simply because Query Analyzer thinks you want the data - not the column headers also. Some say that Query Analyzer that comes with SQL Server 2003 has an option to also copy the column headers. I don&#39;t have it, so I can&#39;t confirm.</p><h2 id=solution>Solution</h2><p>This is somewhat a quick workaround, but it works well for me. I am using SQL Server 2000&#39;s Query Analyzer.</p><ul><li>Tools â†’ Options</li><li>General Tab: Change result file extension to <code>.csv</code></li><li>Results Tab: Change results output format to &quot;Comma Delimited (CSV)&quot;</li><li>Results Tab: Make sure that &quot;print column headers&quot; is checked.</li></ul><p>Now, you just run Query Analyzer like before with no problems. When you want a <code>.csv</code> file, change the results target from Grid (or Text) to File and execute your query again.</p><p>Problem solved.</p><h2 id=shortcomings>Shortcomings</h2><p>If you get back multiple data sets, they will all be in the same <code>.csv</code> file. Also, messages are in the <code>.csv</code> file. So, open up the <code>.csv</code> file and scroll around. At the end of a single-result query, you will see a line that says there were X records returned. You&#39;ll likely want to delete this line.</p><p>Some people say that this does not work well with numbers that have leading zeros, dates, and other things. You might need to perform additional tweaks to get the results to display in the <code>.csv</code> file exactly how you need it.</p></div></main></div></div></div><footer class="Bgc(barBackground) Bgc(tr)--p Bdtw(1px) Bdc(barBorder) C(barText) C(black)--p P(10px) D(f) Fxd(c)--p Jc(spb)"><div class=Fz(0.8em)>&copy; Copyright 2023 Tyler Akins &lt;<a class="Td(n)--p C(barText) C(black)--p" href=mailto:fidian@rumkin.com>fidian@rumkin.com</a>&gt;, last build 2023-03-11T01:11:55.282Z</div><div><a class="D(n)--p Fz(0.8em) C(barText)" href=../../license/ >License</a> | <a class="D(n)--p Fz(0.8em) C(barText)" href=../../reference/site/legal/ >Legal</a> <a class="D(n) D(b)--p Td(n) Fz(0.8em)" href=../../license/ >Site content licensed under a MIT license with a non-advertising clause</a></div></footer></div></body></html>