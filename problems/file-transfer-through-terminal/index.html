<p>I use <code>ssh</code> a lot to connect to remote computers. Sometimes I have to connect to a computer that&#39;s hidden, so I <code>ssh</code> into a jump host and <code>ssh</code> again into the destination. While poking around, I may have the urge to download a file to my computer, but that&#39;s not usually easy to do.</p><h2 id=symptoms>Symptoms</h2><ul><li>Unable to copy a file directly from one machine to another even though you are connected through an interactive session, probably through <code>ssh</code> or another terminal.</li><li>User may copy a file to the intermediate host and then separately copy the file to the destination host, but that means the file temporarily is on the intermediate computer. It also is more work.</li></ul><h2 id=causes>Causes</h2><ul><li>Most terminal emulators do not have file transfer abilities built-in through a side data stream.</li></ul><h2 id=solution>Solution</h2><p>The easiest thing to do is to employ additional software on one side or the other. Slightly harder solutions are also presented. All of these work.</p><p>With luck, problem solved.</p><h3 id=zmodem>ZModem</h3><p>This software was used to transfer files over modems, yet is still readily available in package managers. Plus, <code>screen</code> has ZModem support built in.</p><ol><li>Run <code>screen</code>.</li><li>SSH to any remote server.</li><li>Type Control-a and <code>:</code>, then you will get the <code>screen</code> command prompt.</li><li>Type <code>zmodem capture</code>.</li><li>Install <code>lrzsz</code> on the remote server.</li></ol><p>Now you can use <code>sz</code> to send a file to your local computer or <code>rz</code> to receive one. <code>screen</code> will prompt you with a command when it detects the remote computer is using ZModem.</p><p>You should use <code>ssh -e none</code> to disable sequences like <code>~.</code>, which ZModem does not encode.</p><p>If you prefer to avoid <code>screen</code>, you could use <code>zssh</code> to initiate the SSH connection and it will trigger the zmodem commands automatically, just like how <code>screen</code> works.</p><h3 id=base64-encoding>Base64 Encoding</h3><p>The <code>coreutils</code> package includes <code>base64</code>, which encodes any file. The opposite is <code>base64 --decode</code>.</p><ol><li>SSH to any remote server.</li><li>Capture traffic to a log file. This must be supported by your terminal emulator.</li><li>Run <code>base64 my-file</code> to get the encoded file.</li></ol><p>There are alternate encoding methods available, such as <code>uuencode</code> and <code>xxencode</code> as well. Each has their own advantages.</p><h3 id=port-forwarding>Port Forwarding</h3><p>This exposes the SSH port through the intermediate computer.</p><ol><li>Use <code>ssh -L 8022:real-destination-computer:22 user@intermediate-computer</code> to kick off your SSH session. This also opens port <code>8022</code> on your computer. When you connect to that port, it would be a direct connection to the destination.</li><li>Copy files by specifying the port using <code>scp -P 8022 my-file localhost:</code>.</li></ol><p>This solution can still work through multiple relays by exposing a port and repeatedly forwarding it.</p>