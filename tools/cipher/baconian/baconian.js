"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}var AdvancedInputArea=require("../advanced-input-area"),baconianApplier=require("./baconian-applier"),DirectionSelector=require("../direction-selector"),Dropdown=require("../../../js/mithril/dropdown"),Result=require("../result");module.exports=function(){function e(){_classCallCheck(this,e),this.alphabetInstance=new rumkinCipher.alphabet.English,this.alphabet={value:this.alphabetInstance},this.lastAlphabet=this.alphabetInstance,this.lastResult="",this.condensingOptions={label:"Alphabet style",options:{DISTINCT:"Each letter has a different code",CONDENSED:"Replace J with I and replace V with U"},value:"DISTINCT"},this.direction={},this.input={alphabet:this.alphabet,label:"The hidden message",value:""},this.embeddingOptions={label:"Embedding options",options:{BOLD:"Bold",EMPHASIS:"Emphasis",BOLD_EMPHASIS:"Bold and emphasis"},value:"BOLD"},this.embeddingText={label:"Embed your message in this text",value:""}}return _createClass(e,[{key:"view",value:function(){return[m("p",m(DirectionSelector,this.direction)),m("p",m(Dropdown,this.condensingOptions)),m("p",m(AdvancedInputArea,this.input)),this.viewSwapAB(),m("p",this.viewResult()),this.viewEmbed()]}},{key:"viewEmbed",value:function(){return this.direction.obfuscate?[m("p",m(Dropdown,this.embeddingOptions)),m("p",m(AdvancedInputArea,this.embeddingText)),m("p",this.viewEmbedResult())]:[]}},{key:"viewEmbedResult",value:function(){if(0===this.embeddingText.value.length)return"Enter some text in order to see your message hidden within.";var e="BOLD"===this.embeddingOptions.value?"Fw(b)":"EMPHASIS"===this.embeddingOptions.value?"Fs(i)":"Fw(b) Fs(i)",e=baconianApplier(this.lastAlphabet,this.lastResult,this.embeddingText.value,e);return[m(Result,e.result),this.viewEmbedResultFits(e.encodedMessageFits)]}},{key:"viewEmbedResultFits",value:function(e){return e?[]:m("p","The cipher did not fit into the text provided. Try making it longer. You will need one character per A or B letter in the code.")}},{key:"viewResult",value:function(){if(""===this.input.value.trim())return m(Result,"Enter text to see it encoded here");this.lastAlphabet=this.alphabet.value,"CONDENSED"===this.condensingOptions.value&&(this.lastAlphabet=this.lastAlphabet.collapse("J","I").collapse("V","U"));var e=new rumkinCipher.util.Message(this.input.value),t=rumkinCipher.code.baconian;return this.lastResult=t[this.direction.code](e,this.lastAlphabet).toString(),m(Result,this.lastResult)}},{key:"viewSwapAB",value:function(){var e=this;return this.direction.obfuscate?[]:m("p",m("a",{href:"#",onclick:function(){return e.input.value=e.input.value.replace(/[0Aa1Bb]/g,function(e){switch(e){case"0":return"1";case"1":return"0";case"A":return"B";case"B":return"A";case"a":return"b";case"b":return"a";default:return e}}),!1}},"Swap A and B"))}}]),e}();