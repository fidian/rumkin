"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}var AdvancedInputArea=require("../advanced-input-area"),AlphabetSelector=require("../alphabet-selector"),baconianApplier=require("./baconian-applier"),cipherConduitSetup=require("../cipher-conduit-setup"),CipherResult=require("../cipher-result"),DirectionSelector=require("../direction-selector"),Dropdown=require("../../../js/mithril/dropdown"),Result=require("../result");module.exports=function(){function e(){_classCallCheck(this,e),this.alphabet={value:new rumkinCipher.alphabet.English},this.condensingOptions={label:"Alphabet style",options:{DISTINCT:"Each letter has a different code",CONDENSED:"Replace J with I and replace V with U"},value:"DISTINCT"},this.direction={},this.input={label:"The hidden message",value:""},this.embeddingOptions={label:"Embedding options",options:{BOLD:"Bold",EMPHASIS:"Emphasis",BOLD_EMPHASIS:"Bold and emphasis"},value:"BOLD"},this.embeddingText={label:"Embed your message in this text",value:""},cipherConduitSetup(this,"baconian")}return _createClass(e,[{key:"adjustAlphabet",value:function(){var e=this.alphabet.value;return e="CONDENSED"===this.condensingOptions.value?e.collapse("J","I").collapse("V","U"):e}},{key:"view",value:function(){return[m("p",m(DirectionSelector,this.direction)),m("p",m(AlphabetSelector,this.alphabet)),m("p",m(Dropdown,this.condensingOptions)),m("p",m(AdvancedInputArea,this.input)),this.viewSwapAB(),m("p",this.viewResult()),this.viewEmbed()]}},{key:"viewEmbed",value:function(){return"ENCRYPT"!==this.direction.value?[]:[m("p",m(Dropdown,this.embeddingOptions)),m("p",m(AdvancedInputArea,this.embeddingText)),m("p",this.viewEmbedResult())]}},{key:"viewEmbedResult",value:function(){if(0===this.embeddingText.value.length)return"Enter some text in order to see your message hidden within.";var e="BOLD"===this.embeddingOptions.value?"Fw(b)":"EMPHASIS"===this.embeddingOptions.value?"Fs(i)":"Fw(b) Fs(i)",t=new rumkinCipher.util.Message(this.input.value),t=rumkinCipher.code.baconian.encode(t,this.adjustAlphabet()).toString(),t=baconianApplier(this.alphabet.value,t,this.embeddingText.value,e);return[m(Result,t.result),this.viewEmbedResultFits(t.encodedMessageFits)]}},{key:"viewEmbedResultFits",value:function(e){return e?[]:m("p","The cipher did not fit into the text provided. Try making it longer. You will need one character per A or B letter in the code.")}},{key:"viewResult",value:function(){return""===this.input.value.trim()?m(Result,"Enter text to see it encoded here"):m(CipherResult,{name:"baconian",direction:this.direction.value,message:this.input.value,alphabet:this.adjustAlphabet()})}},{key:"viewSwapAB",value:function(){var e=this;return this.direction.obfuscate?[]:m("p",m("a",{href:"#",onclick:function(){return e.input.value=e.input.value.replace(/[0Aa1Bb]/g,function(e){switch(e){case"0":return"1";case"1":return"0";case"A":return"B";case"B":return"A";case"a":return"b";case"b":return"a";default:return e}}),!1}},"Swap A and B"))}}]),e}();