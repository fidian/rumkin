"use strict";function _typeof(s){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(s){return typeof s}:function(s){return s&&"function"==typeof Symbol&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s})(s)}function _classCallCheck(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(s,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(s,_toPropertyKey(r.key),r)}}function _createClass(s,e,t){return e&&_defineProperties(s.prototype,e),t&&_defineProperties(s,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function _toPropertyKey(s){s=_toPrimitive(s,"string");return"symbol"===_typeof(s)?s:String(s)}function _toPrimitive(s,e){if("object"!==_typeof(s)||null===s)return s;var t=s[Symbol.toPrimitive];if(void 0===t)return("string"===e?String:Number)(s);t=t.call(s,e||"default");if("object"!==_typeof(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}var PasswordStrengthModule=require("tai-password-strength/lib/password-strength");module.exports=function(){function s(){var e=this;_classCallCheck(this,s),this.password="",this.showPassword=!1,this.strengthScore=null,this.commonPasswords=null,this.passwordStrength=new PasswordStrengthModule,this.filesLoading=2,m.request({url:"common-passwords.json"}).then(function(s){e.passwordStrength.addCommonPasswords(s),--e.filesLoading}),m.request({url:"trigraphs.json"}).then(function(s){e.passwordStrength.addTrigraphMap(s),--e.filesLoading})}return _createClass(s,[{key:"updatePassword",value:function(s){this.password=s,this.strengthScore=s?this.passwordStrength.check(s):null}},{key:"view",value:function(){var e=this;return this.filesLoading?m("p",{class:"output"},"Loading necessary files."):[m("p",m("label",[m("input",{type:"checkbox",checked:this.showPassword,onclick:function(){e.showPassword=!e.showPassword}})," Show password"]),m("br"),m("input",{type:this.showPassword?"text":"password",placeholder:"Password or passphrase",class:"W(100%)",value:this.password,oninput:function(s){return e.updatePassword(s.target.value)}})),m("div",{class:"output"},this.viewResult())]}},{key:"viewResult",value:function(){if(!this.password)return m("div",{class:"Py(0.5em"},"Enter a password or passphrase to analyze");var s=[],e=this.strengthScore,t=(e.commonPassword&&s.push("WARNING: This is a common password!")," ".concat(Math.floor(e.trigraphEntropyBits)," bits of entropy."));switch(e.strengthCode){case"VERY_STRONG":s.push(["This password is very strong, with about",t]);break;case"STRONG":s.push(["You have a strong password, which provides approximately",t]);break;case"REASONABLE":s.push(["Your password seems to be fairly good, and has",t]);break;case"WEAK":s.push(["Your password is weak and can be cracked or guessed easily. It provides",t]);break;default:s.push([m("span",{class:"Fw(b)"},"VERY WEAK PASSWORD!")," There are only",t])}return s.push(["Suggestions for improvement:",m("ul",{class:"Py(0) My(0)"},this.viewSuggestions())]),s.map(function(s){return m("div",{class:"Py(0.5em)"},s)})}},{key:"viewSuggestions",value:function(){var s=[m("li","Make the passphrase longer.")],e=this.strengthScore.charsets;return e.lower||s.push(m("li","Add lowercase letters.")),e.upper||s.push(m("li","Add uppercase letters.")),e.number||s.push(m("li","Add numbers.")),e.punctuation||s.push(m("li","Add punctuation.")),e.symbol||s.push(m("li","Add symbols, such as ones used for math.")),s}}]),s}();