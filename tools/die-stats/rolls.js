"use strict";function _typeof(r){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}function _slicedToArray(r,t){return _arrayWithHoles(r)||_iterableToArrayLimit(r,t)||_unsupportedIterableToArray(r,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(r,t){var e=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=e){var n,o,a,i,u=[],l=!0,f=!1;try{if(a=(e=e.call(r)).next,0===t){if(Object(e)!==e)return;l=!1}else for(;!(l=(n=a.call(e)).done)&&(u.push(n.value),u.length!==t);l=!0);}catch(r){f=!0,o=r}finally{try{if(!l&&null!=e.return&&(i=e.return(),Object(i)!==i))return}finally{if(f)throw o}}return u}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function _createForOfIteratorHelper(r,t){var e,n,o,a,i="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(i)return n=!(e=!0),{s:function(){i=i.call(r)},n:function(){var r=i.next();return e=r.done,r},e:function(r){n=!0,o=r},f:function(){try{e||null==i.return||i.return()}finally{if(n)throw o}}};if(Array.isArray(r)||(i=_unsupportedIterableToArray(r))||t&&r&&"number"==typeof r.length)return i&&(r=i),a=0,{s:t=function(){},n:function(){return a>=r.length?{done:!0}:{done:!1,value:r[a++]}},e:function(r){throw r},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,t){var e;if(r)return"string"==typeof r?_arrayLikeToArray(r,t):"Map"===(e="Object"===(e=Object.prototype.toString.call(r).slice(8,-1))&&r.constructor?r.constructor.name:e)||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(r,t):void 0}function _arrayLikeToArray(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function _classCallCheck(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,_toPropertyKey(n.key),n)}}function _createClass(r,t,e){return t&&_defineProperties(r.prototype,t),e&&_defineProperties(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function _toPropertyKey(r){r=_toPrimitive(r,"string");return"symbol"===_typeof(r)?r:String(r)}function _toPrimitive(r,t){if("object"!==_typeof(r)||null===r)return r;var e=r[Symbol.toPrimitive];if(void 0===e)return("string"===t?String:Number)(r);e=e.call(r,t||"default");if("object"!==_typeof(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}module.exports=function(){function t(){_classCallCheck(this,t),this.map=new Map,this.bonus=0}return _createClass(t,[{key:"add",value:function(r,t){r=r.slice(),r.sort(function(r,t){return r-t}).map(function(r){return r.toString()}),r=r.join(",");this.map.set(r,t+(this.map.get(r)||0))}},{key:"count",value:function(){return this.map.size}},{key:"forEach",value:function(r){var t,e=_createForOfIteratorHelper(this.map.entries());try{for(e.s();!(t=e.n()).done;){var n=_slicedToArray(t.value,2),o=n[0],a=n[1];r(o.split(",").map(function(r){return+r}),a)}}catch(r){e.e(r)}finally{e.f()}}},{key:"sums",value:function(){var a=this,i=new t;return this.forEach(function(r,t){var e,n=0,o=_createForOfIteratorHelper(r);try{for(o.s();!(e=o.n()).done;)n+=e.value}catch(r){o.e(r)}finally{o.f()}i.add([n+a.bonus],t)}),i}},{key:"adjustBonus",value:function(r){this.bonus+=+r||0}},{key:"getBonus",value:function(){return this.bonus}},{key:"fork",value:function(){var r=new t;return r.adjustBonus(this.bonus),r}},{key:"mergeWith",value:function(r){var o=this.fork();return this.forEach(function(e,n){r.forEach(function(r,t){o.add([].concat(_toConsumableArray(e),_toConsumableArray(r)),n*t)})}),o}},{key:"consolidate",value:function(){var a=this,i=0<arguments.length&&void 0!==arguments[0]&&arguments[0],u=new t;return this.forEach(function(r,t){var e,n=a.bonus,o=(i&&(n+=a.bonus),_createForOfIteratorHelper(r));try{for(o.s();!(e=o.n()).done;)n+=e.value}catch(r){o.e(r)}finally{o.f()}u.add([n],t)}),u}},{key:"snapshot",value:function(){return{bonus:this.bonus,map:Object.fromEntries(this.map)}}}]),t}();