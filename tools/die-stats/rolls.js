"use strict";function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(r,e){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var n,o,a=[],i=!0,u=!1;try{for(t=t.call(r);!(i=(n=t.next()).done)&&(a.push(n.value),!e||a.length!==e);i=!0);}catch(r){u=!0,o=r}finally{try{i||null==t.return||t.return()}finally{if(u)throw o}}return a}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function _createForOfIteratorHelper(r,e){var t,n="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!n){if(Array.isArray(r)||(n=_unsupportedIterableToArray(r))||e&&r&&"number"==typeof r.length)return n&&(r=n),t=0,{s:e=function(){},n:function(){return t>=r.length?{done:!0}:{done:!1,value:r[t++]}},e:function(r){throw r},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){n=n.call(r)},n:function(){var r=n.next();return a=r.done,r},e:function(r){i=!0,o=r},f:function(){try{a||null==n.return||n.return()}finally{if(i)throw o}}}}function _unsupportedIterableToArray(r,e){if(r){if("string"==typeof r)return _arrayLikeToArray(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);return"Map"===(t="Object"===t&&r.constructor?r.constructor.name:t)||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,e):void 0}}function _arrayLikeToArray(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function _classCallCheck(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function _createClass(r,e,t){return e&&_defineProperties(r.prototype,e),t&&_defineProperties(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}module.exports=function(){function e(){_classCallCheck(this,e),this.map=new Map,this.bonus=0}return _createClass(e,[{key:"add",value:function(r,e){r=r.slice(),r.sort(function(r,e){return r-e}).map(function(r){return r.toString()}),r=r.join(",");this.map.set(r,e+(this.map.get(r)||0))}},{key:"count",value:function(){return this.map.size}},{key:"forEach",value:function(r){var e,t=_createForOfIteratorHelper(this.map.entries());try{for(t.s();!(e=t.n()).done;){var n=_slicedToArray(e.value,2),o=n[0],a=n[1];r(o.split(",").map(function(r){return+r}),a)}}catch(r){t.e(r)}finally{t.f()}}},{key:"sums",value:function(){var a=this,i=new e;return this.forEach(function(r,e){var t,n=0,o=_createForOfIteratorHelper(r);try{for(o.s();!(t=o.n()).done;)n+=t.value}catch(r){o.e(r)}finally{o.f()}i.add([n+a.bonus],e)}),i}},{key:"adjustBonus",value:function(r){this.bonus+=+r||0}},{key:"getBonus",value:function(){return this.bonus}},{key:"fork",value:function(){var r=new e;return r.adjustBonus(this.bonus),r}},{key:"mergeWith",value:function(r){var o=this.fork();return this.forEach(function(t,n){r.forEach(function(r,e){o.add([].concat(_toConsumableArray(t),_toConsumableArray(r)),n*e)})}),o}},{key:"consolidate",value:function(){var a=this,i=0<arguments.length&&void 0!==arguments[0]&&arguments[0],u=this.fork();return this.forEach(function(r,e){var t,n=0,o=(i&&(n+=a.bonus),_createForOfIteratorHelper(r));try{for(o.s();!(t=o.n()).done;)n+=t.value}catch(r){o.e(r)}finally{o.f()}u.add([n],e)}),u}},{key:"snapshot",value:function(){return{bonus:this.bonus,map:Object.fromEntries(this.map)}}}]),e}();