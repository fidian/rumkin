"use strict";function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(i="Object"===i&&t.constructor?t.constructor.name:i)||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}function _iterableToArrayLimit(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var r,n,s=[],o=!0,a=!1;try{for(i=i.call(t);!(o=(r=i.next()).done)&&(s.push(r.value),!e||s.length!==e);o=!0);}catch(t){a=!0,n=t}finally{try{o||null==i.return||i.return()}finally{if(a)throw n}}return s}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}!function r(n,s,o){function a(e,t){if(!s[e]){if(!n[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(h)return h(e,!0);throw(t=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",t}i=s[e]={exports:{}},n[e][0].call(i.exports,function(t){return a(n[e][1][t]||t)},i,i.exports,r,n,s,o)}return s[e].exports}for(var h="function"==typeof require&&require,t=0;t<o.length;t++)a(o[t]);return a}({1:[function(t,e,i){function r(t){null==t&&(t=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,t.constructor==Array?this.init_by_array(t,t.length):this.init_seed(t)}r.prototype.init_seed=function(t){for(this.mt[0]=t>>>0,this.mti=1;this.mti<this.N;this.mti++){t=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&t)>>>16)<<16)+1812433253*(65535&t)+this.mti,this.mt[this.mti]>>>=0}},r.prototype.init_by_array=function(t,e){var i,r,n;for(this.init_seed(19650218),i=1,r=0,n=this.N>e?this.N:e;n;n--){var s=this.mt[i-1]^this.mt[i-1]>>>30;this.mt[i]=(this.mt[i]^(1664525*((4294901760&s)>>>16)<<16)+1664525*(65535&s))+t[r]+r,this.mt[i]>>>=0,r++,++i>=this.N&&(this.mt[0]=this.mt[this.N-1],i=1),e<=r&&(r=0)}for(n=this.N-1;n;n--){s=this.mt[i-1]^this.mt[i-1]>>>30;this.mt[i]=(this.mt[i]^(1566083941*((4294901760&s)>>>16)<<16)+1566083941*(65535&s))-i,this.mt[i]>>>=0,++i>=this.N&&(this.mt[0]=this.mt[this.N-1],i=1)}this.mt[0]=2147483648},r.prototype.random_int=function(){var t,e,i=new Array(0,this.MATRIX_A);if(this.mti>=this.N){for(this.mti==this.N+1&&this.init_seed(5489),e=0;e<this.N-this.M;e++)t=this.mt[e]&this.UPPER_MASK|this.mt[e+1]&this.LOWER_MASK,this.mt[e]=this.mt[e+this.M]^t>>>1^i[1&t];for(;e<this.N-1;e++)t=this.mt[e]&this.UPPER_MASK|this.mt[e+1]&this.LOWER_MASK,this.mt[e]=this.mt[e+(this.M-this.N)]^t>>>1^i[1&t];t=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^t>>>1^i[1&t],this.mti=0}return t=this.mt[this.mti++],(t=(t=(t=(t^=t>>>11)^t<<7&2636928640)^t<<15&4022730752)^t>>>18)>>>0},r.prototype.random_int31=function(){return this.random_int()>>>1},r.prototype.random_incl=function(){return this.random_int()*(1/4294967295)},r.prototype.random=function(){return this.random_int()*(1/4294967296)},r.prototype.random_excl=function(){return(this.random_int()+.5)*(1/4294967296)},r.prototype.random_long=function(){return 1/9007199254740992*(67108864*(this.random_int()>>>5)+(this.random_int()>>>6))},e.exports=r},{}],2:[function(t,e,i){var r=new(t("mersenne-twister"))(Math.random()*Number.MAX_SAFE_INTEGER);e.exports=function(t){var e=t.length;for(;e--;)t[e]=Math.floor(256*r.random());return t}},{"mersenne-twister":1}],3:[function(t,e,i){var h=t("polyfill-crypto.getrandomvalues"),r=window.crypto||window.msCrypto,l=(r&&r.getRandomValues&&Uint32Array&&(h=function(t){return r.getRandomValues(t)}),Number.MAX_SAFE_INTEGER);e.exports={number:function(){var t=l;try{for(;t===l;){var e=new Uint32Array(2);h(e),t=2097151&e[0],t=(t*=4294967296)+e[1]}return t/l}catch(t){return Math.random()}},index:function(e){try{if(l<e)throw new Error;for(var t=1,i=1;t<e;)t=2*t+1,i+=1;if(i<=32){for(var r=e;e<=r;){var n=new Uint32Array(1);h(n),r=n[0]&t}return r}for(var s=0;s<32;s+=1)--t,t/=2,--i;for(var o=e;e<=o;){var a=new Uint32Array(2);h(a),o=a[0]&t,o=(o*=4294967296)+a[1]}return o}catch(t){return Math.floor(Math.random()*e)}},maxSafeInteger:l}},{"polyfill-crypto.getrandomvalues":2}],4:[function(t,e,i){var r=function(){function t(){_classCallCheck(this,t),this.loadPromise=null}return _createClass(t,[{key:"load",value:function(){return this.loadPromise||(this.loadPromise=this.loadData()),this.loadPromise}},{key:"loadData",value:function(){var n=this;return Promise.all([m.request({url:"populations.json"}),m.request({url:"regions-rename.json"}),m.request({url:"stats-start-date.json"})]).then(function(t){var t=_slicedToArray(t,3),e=t[0],i=t[1],t=t[2],r={};return r.statsById=e,r.countries=n.filterAreas(e,{},function(t){return t.I<900}),r.regions=n.filterAreas(e,i,function(t){return 900<=t.I}),r.statsStartDate=new Date(t),n.update(r),setInterval(function(){return n.update(r)},100),r})}},{key:"filterAreas",value:function(t,e,i){for(var r=[],n=0,s=Object.values(t);n<s.length;n++){var o=s[n];i(o)&&r.push(o),e[o.I]&&(o.L=e[o.I])}return r.sort(function(t,e){t=t.L.toLowerCase(),e=e.L.toLowerCase();return t<e?-1:e<t?1:0}),r}},{key:"update",value:function(t){for(var e=0,i=Object.values(t.statsById);e<i.length;e++){var r=i[e];this.updateRegion(r,t.statsStartDate)}m.redraw()}},{key:"updateRegion",value:function(t,e){var i=new Date,i=(t.days=(i-e)/864e5,t.days/365.2425);t.births=Math.floor(t.B*i),t.deaths=Math.floor(t.D*i),t.migrations=Math.floor(t.M*i),t.population=t.P+t.births-t.deaths+t.migrations}}]),t}();e.exports=new r},{}],5:[function(t,e,i){var r=t("./data-loader");e.exports=function(){function t(){var e=this;_classCallCheck(this,t),this.loaded=!1,r.load().then(function(t){e.loaded=t})}return _createClass(t,[{key:"view",value:function(){return this.loaded?[m("p","Select a country or region in order to see details on its estimated population."),m("h2","Regions"),m("ul",{class:"Colm(2) Colm(1)--s"},this.regionList(this.loaded.regions)),m("h2","Countries"),m("ul",{class:"Colm(2) Colm(1)--s"},this.regionList(this.loaded.countries))]:m("p",{class:"output"},"Loading the population statistics.")}},{key:"regionList",value:function(t){return t.map(function(t){return m("li",[m(m.route.Link,{href:"/".concat(t.I)},t.L),m("br"),m("span",{class:"Pstart(2em)"},t.population.toLocaleString())])})}}]),t}()},{"./data-loader":4}],6:[function(t,e,i){window.PopulationIndex=t("./population-index"),window.PopulationRegion=t("./population-region")},{"./population-index":5,"./population-region":7}],7:[function(t,e,i){var r=t("./data-loader"),o=t("../../js/module/random");e.exports=function(){function t(){_classCallCheck(this,t),this.loaded=!1,this.invalid=!1,this.selected={},this.notes={}}return _createClass(t,[{key:"setId",value:function(t){var e=this;this.region=t,r.load().then(function(t){(e.loaded=t).statsById[e.region]?(e.selected=t.statsById[e.region],e.updateNotes()):e.invalid=!0})}},{key:"view",value:function(t){return this.region!==t.attrs.region&&this.setId(t.attrs.region),this.loaded?this.invalid?m("div",{class:"output"},[m("p","Invalid region specifier."),this.backLink()]):(this.updateNotes(),[m("h2",this.selected.L),m("p","Current estimated population: ".concat(this.selected.population)),m("p","All projections start from ".concat(this.loaded.statsStartDate.toISOString().split("T")[0],". It's been ").concat(Math.floor((new Date-this.loaded.statsStartDate)/864e5)," days since.")),m("table",[m("tr",[m("th","Births"),m("td",this.selected.births)]),m("tr",[m("th","Last Birth"),m("td",this.selectedBirthNote())]),m("tr",[m("th","Deaths"),m("td",this.selected.deaths)]),m("tr",[m("th","Last Death"),m("td",this.selectedDeathNote())]),m("tr",[m("th",this.migrationsLabel()),m("td",this.migrationsValue())])]),this.backLink()]):m("div",{class:"output"},[m("p","Loading the population statistics."),this.backLink()])}},{key:"backLink",value:function(){return m("p",m(m.route.Link,{href:"/"},"← Back to the country list."))}},{key:"selectedBirthNote",value:function(){var t=this.notes.birthNote.male?"Male":"Female";return"".concat(t,", may live to be ").concat(this.notes.birthNote.ageRange)}},{key:"selectedDeathNote",value:function(){var t=this.notes.deathNote.male?"Male":"Female";return"".concat(t,", age could have been ").concat(this.notes.deathNote.ageRange)}},{key:"migrationsLabel",value:function(){return 0<this.selected.migrations?"Migrations In":this.selected.migrations<0?"Migrations Out":"Migrations"}},{key:"migrationsValue",value:function(){return this.selected.migrations?Math.abs(this.selected.migrations):"None"}},{key:"updateNotes",value:function(){this.notes.births!==this.selected.births&&(this.notes.births=this.selected.births,this.notes.birthNote=this.makeNote(this.selected.BMP,this.selected.DM,this.selected.DF)),this.notes.deaths!==this.selected.deaths&&(this.notes.deaths=this.selected.deaths,this.notes.deathNote=this.makeNote(this.selected.DMP,this.selected.DM,this.selected.DF))}},{key:"makeNote",value:function(t,e,i){t=o.number()<=t;return{ageRange:this.findAge(t?e:i),male:t}}},{key:"findAge",value:function(t){for(var e=o.number(),i=0,r=Object.entries(t);i<r.length;i++){var n=_slicedToArray(r[i],2),s=n[0],n=n[1];if(e<n)return s;e-=n}return"?"}}]),t}()},{"../../js/module/random":3,"./data-loader":4}]},{},[6]);