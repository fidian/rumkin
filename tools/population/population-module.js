"use strict";function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(r="Object"===r&&t.constructor?t.constructor.name:r)||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var i,n,o=[],s=!0,a=!1;try{for(r=r.call(t);!(s=(i=r.next()).done)&&(o.push(i.value),!e||o.length!==e);s=!0);}catch(t){a=!0,n=t}finally{try{s||null==r.return||r.return()}finally{if(a)throw n}}return o}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}!function i(n,o,s){function a(e,t){if(!o[e]){if(!n[e]){var r="function"==typeof require&&require;if(!t&&r)return r(e,!0);if(h)return h(e,!0);throw(t=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",t}r=o[e]={exports:{}},n[e][0].call(r.exports,function(t){return a(n[e][1][t]||t)},r,r.exports,i,n,o,s)}return o[e].exports}for(var h="function"==typeof require&&require,t=0;t<s.length;t++)a(s[t]);return a}({1:[function(t,e,r){function i(t){null==t&&(t=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,t.constructor==Array?this.init_by_array(t,t.length):this.init_seed(t)}i.prototype.init_seed=function(t){for(this.mt[0]=t>>>0,this.mti=1;this.mti<this.N;this.mti++){t=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&t)>>>16)<<16)+1812433253*(65535&t)+this.mti,this.mt[this.mti]>>>=0}},i.prototype.init_by_array=function(t,e){var r,i,n;for(this.init_seed(19650218),r=1,i=0,n=this.N>e?this.N:e;n;n--){var o=this.mt[r-1]^this.mt[r-1]>>>30;this.mt[r]=(this.mt[r]^(1664525*((4294901760&o)>>>16)<<16)+1664525*(65535&o))+t[i]+i,this.mt[r]>>>=0,i++,++r>=this.N&&(this.mt[0]=this.mt[this.N-1],r=1),e<=i&&(i=0)}for(n=this.N-1;n;n--){o=this.mt[r-1]^this.mt[r-1]>>>30;this.mt[r]=(this.mt[r]^(1566083941*((4294901760&o)>>>16)<<16)+1566083941*(65535&o))-r,this.mt[r]>>>=0,++r>=this.N&&(this.mt[0]=this.mt[this.N-1],r=1)}this.mt[0]=2147483648},i.prototype.random_int=function(){var t,e,r=new Array(0,this.MATRIX_A);if(this.mti>=this.N){for(this.mti==this.N+1&&this.init_seed(5489),e=0;e<this.N-this.M;e++)t=this.mt[e]&this.UPPER_MASK|this.mt[e+1]&this.LOWER_MASK,this.mt[e]=this.mt[e+this.M]^t>>>1^r[1&t];for(;e<this.N-1;e++)t=this.mt[e]&this.UPPER_MASK|this.mt[e+1]&this.LOWER_MASK,this.mt[e]=this.mt[e+(this.M-this.N)]^t>>>1^r[1&t];t=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^t>>>1^r[1&t],this.mti=0}return t=this.mt[this.mti++],(t=(t=(t=(t^=t>>>11)^t<<7&2636928640)^t<<15&4022730752)^t>>>18)>>>0},i.prototype.random_int31=function(){return this.random_int()>>>1},i.prototype.random_incl=function(){return this.random_int()*(1/4294967295)},i.prototype.random=function(){return this.random_int()*(1/4294967296)},i.prototype.random_excl=function(){return(this.random_int()+.5)*(1/4294967296)},i.prototype.random_long=function(){return 1/9007199254740992*(67108864*(this.random_int()>>>5)+(this.random_int()>>>6))},e.exports=i},{}],2:[function(t,e,r){var i=new(t("mersenne-twister"))(Math.random()*Number.MAX_SAFE_INTEGER);e.exports=function(t){var e=t.length;for(;e--;)t[e]=Math.floor(256*i.random());return t}},{"mersenne-twister":1}],3:[function(t,e,r){var h=t("polyfill-crypto.getrandomvalues"),i=window.crypto||window.msCrypto,u=(i&&i.getRandomValues&&Uint32Array&&(h=function(t){return i.getRandomValues(t)}),Number.MAX_SAFE_INTEGER);e.exports={number:function(){var t=u;try{for(;t===u;){var e=new Uint32Array(2);h(e),t=2097151&e[0],t=(t*=4294967296)+e[1]}return t/u}catch(t){return Math.random()}},index:function(e){try{if(u<e)throw new Error;for(var t=1,r=1;t<e;)t=2*t+1,r+=1;if(r<=32){for(var i=e;e<=i;){var n=new Uint32Array(1);h(n),i=n[0]&t}return i}for(var o=0;o<32;o+=1)--t,t/=2,--r;for(var s=e;e<=s;){var a=new Uint32Array(2);h(a),s=a[0]&t,s=(s*=4294967296)+a[1]}return s}catch(t){return Math.floor(Math.random()*e)}},maxSafeInteger:u}},{"polyfill-crypto.getrandomvalues":2}],4:[function(t,e,r){var i=function(){function t(){_classCallCheck(this,t),this.loadPromise=null}return _createClass(t,[{key:"load",value:function(){return this.loadPromise||(this.loadPromise=this.loadData()),this.loadPromise}},{key:"loadData",value:function(){var n=this;function t(e){try{return JSON.parse(e.responseText)}catch(t){console.error(t),console.error(e)}return{}}return Promise.all([m.request({extract:t,url:"populations.json"}),m.request({extract:t,url:"regions-rename.json"}),m.request({extract:t,url:"stats-start-date.json"})]).then(function(t){var t=_slicedToArray(t,3),e=t[0],r=t[1],t=t[2],i={};return i.statsById=e,i.countries=n.filterAreas(e,{},function(t){return t.I<900}),i.regions=n.filterAreas(e,r,function(t){return 900<=t.I}),i.statsStartDate=new Date(t),n.update(i),setInterval(function(){return n.update(i)},100),i})}},{key:"filterAreas",value:function(t,e,r){for(var i=[],n=0,o=Object.values(t);n<o.length;n++){var s=o[n];r(s)&&i.push(s),e[s.I]&&(s.L=e[s.I])}return i.sort(function(t,e){t=t.L.toLowerCase(),e=e.L.toLowerCase();return t<e?-1:e<t?1:0}),i}},{key:"update",value:function(t){for(var e=0,r=Object.values(t.statsById);e<r.length;e++){var i=r[e];this.updateRegion(i,t.statsStartDate)}m.redraw()}},{key:"updateRegion",value:function(t,e){var r=new Date,r=(t.days=(r-e)/864e5,t.days/365.2425);t.births=Math.floor(t.B*r),t.deaths=Math.floor(t.D*r),t.migrations=Math.floor(t.M*r),t.population=t.P+t.births-t.deaths+t.migrations}}]),t}();e.exports=new i},{}],5:[function(t,e,r){var i=t("./data-loader");e.exports=function(){function t(){var e=this;_classCallCheck(this,t),this.loaded=!1,i.load().then(function(t){e.loaded=t})}return _createClass(t,[{key:"view",value:function(){return this.loaded?[m("p","Select a country or region in order to see its estimated population."),m("h2","Regions"),m("ul",this.regionList(this.loaded.regions)),m("h2","Countries"),m("ul",this.regionList(this.loaded.countries))]:m("p",{class:"output"},"Loading the population statistics.")}},{key:"regionList",value:function(t){return t.map(function(t){return m("li",[m(m.route.Link,{href:"/".concat(t.I)},t.L)," (".concat(t.population.toLocaleString(),")")])})}}]),t}()},{"./data-loader":4}],6:[function(t,e,r){window.PopulationIndex=t("./population-index"),window.PopulationRegion=t("./population-region")},{"./population-index":5,"./population-region":7}],7:[function(t,e,r){var i=t("./data-loader"),s=t("../../js/module/random");e.exports=function(){function t(){_classCallCheck(this,t),this.loaded=!1,this.invalid=!1,this.selected={},this.notes={}}return _createClass(t,[{key:"setId",value:function(t){var e=this;this.region=t,i.load().then(function(t){(e.loaded=t).statsById[e.region]?(e.selected=t.statsById[e.region],e.updateNotes()):e.invalid=!0})}},{key:"view",value:function(t){return this.region!==t.attrs.region&&this.setId(t.attrs.region),this.loaded?this.invalid?m("div",{class:"output"},[m("p","Invalid region specifier."),this.backLink()]):(this.updateNotes(),[m("h2",this.selected.L),m("p","Current estimated population: ".concat(this.selected.population)),m("p","All projections start from ".concat(this.loaded.statsStartDate.toISOString().split("T")[0],". It's been ").concat(Math.floor((new Date-this.loaded.statsStartDate)/864e5)," days since.")),m("table",[m("tr",[m("th","Births"),m("td",this.selected.births)]),m("tr",[m("th","Last Birth"),m("td",this.selectedBirthNote())]),m("tr",[m("th","Deaths"),m("td",this.selected.deaths)]),m("tr",[m("th","Last Death"),m("td",this.selectedDeathNote())]),m("tr",[m("th",this.migrationsLabel()),m("td",this.migrationsValue())])]),this.backLink()]):m("div",{class:"output"},[m("p","Loading the population statistics."),this.backLink()])}},{key:"backLink",value:function(){return m("p",m(m.route.Link,{href:"/"},"← Back to the country list."))}},{key:"selectedBirthNote",value:function(){var t=this.notes.birthNote.male?"Male":"Female";return"".concat(t,", may live to be ").concat(this.notes.birthNote.ageRange)}},{key:"selectedDeathNote",value:function(){var t=this.notes.deathNote.male?"Male":"Female";return"".concat(t,", age could have been ").concat(this.notes.deathNote.ageRange)}},{key:"migrationsLabel",value:function(){return 0<this.selected.migrations?"Migrations In":this.selected.migrations<0?"Migrations Out":"Migrations"}},{key:"migrationsValue",value:function(){return this.selected.migrations?Math.abs(this.selected.migrations):"None"}},{key:"updateNotes",value:function(){this.notes.births!==this.selected.births&&(this.notes.births=this.selected.births,this.notes.birthNote=this.makeNote(this.selected.BMP,this.selected.DM,this.selected.DF)),this.notes.deaths!==this.selected.deaths&&(this.notes.deaths=this.selected.deaths,this.notes.deathNote=this.makeNote(this.selected.DMP,this.selected.DM,this.selected.DF))}},{key:"makeNote",value:function(t,e,r){t=s.number()<=t;return{ageRange:this.findAge(t?e:r),male:t}}},{key:"findAge",value:function(t){for(var e=s.number(),r=0,i=Object.entries(t);r<i.length;r++){var n=_slicedToArray(i[r],2),o=n[0],n=n[1];if(e<n)return o;e-=n}return"?"}}]),t}()},{"../../js/module/random":3,"./data-loader":4}]},{},[6]);