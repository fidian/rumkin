<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var b=window,e="chrome",g="tick",h="wtsrt_",l="tbsd_",m="tbnd_",n="start",p="_wtsrt",q="_tbnd",r="CSI/";(function(){function k(a){this.t={};this.tick=function(a,d,c){this.t[a]=[void 0!=c?c:(new Date).getTime(),d];if(void 0==c)try{b.console.timeStamp(r+a)}catch(f){}};this[g](n,null,a)}var a;b.performance&&(a=b.performance.timing);var t=a?new k(a.responseStart):new k;b.jstiming={Timer:k,load:t};if(a){var d=a.navigationStart,f=a.responseStart;0<d&&f>=d&&(b.jstiming.srt=f-d)}if(a){var c=b.jstiming.load;0<d&&f>=d&&(c[g](p,void 0,d),c[g](h,p,f),c[g](l,h))}try{a=null,b[e]&&b[e].csi&&(a=Math.floor(b[e].csi().pageT),
c&&0<d&&(c[g](q,void 0,b[e].csi().startE),c[g](m,q,d))),null==a&&b.gtbExternal&&(a=b.gtbExternal.pageT()),null==a&&b.external&&(a=b.external.pageT,c&&0<d&&(c[g](q,void 0,b.external.startE),c[g](m,q,d))),a&&(b.jstiming.pt=a)}catch(u){}})(); })()
</script>
<link rel="shortcut icon" href="../_/rsrc/1315833693572/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="http://www.gstatic.com/sites/p/25ccba/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d=window,e="length",h="",k="__duration__",l="function";function m(c){return document.getElementById(c)}d.byId=m;function n(c){return c.replace(/^\s+|\s+$/g,h)}d.trim=n;var p=[],q=0;d.JOT_addListener=function(c,a,b){var f=new String(q++);c={eventName:c,handler:a,compId:b,key:f};p.push(c);return f};d.JOT_removeListenerByKey=function(c){for(var a=0;a<p[e];a++)if(p[a].key==c){p.splice(a,1);break}};d.JOT_removeAllListenersForName=function(c){for(var a=0;a<p[e];a++)p[a].eventName==c&&p.splice(a,1)};
d.JOT_postEvent=function(c,a,b){var f={eventName:c,eventSrc:a||{},payload:b||{}};if(d.JOT_fullyLoaded)for(a=p[e],b=0;b<a&&b<p[e];b++){var g=p[b];g&&g.eventName==c&&(f.listenerCompId=g.compId||h,(g=typeof g.handler==l?g.handler:d[g.handler])&&g(f))}else d.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};d.JOT_delayedEvents=[];d.JOT_fullyLoaded=!1;
d.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var f=0;60<=b&&(b/=60,f=2);2<=b&&f++;return a?d.JOT_siteRelTimeStrs[f].replace(k,Math.floor(b)):d.JOT_userRelTimeStrs[f].replace(k,Math.floor(b))}; })()
</script>
<link rel="stylesheet" type="text/css" href="http://www.gstatic.com/sites/p/25ccba/system/app/pagetypes/announcements/announcements.css" />
<script>

  

  var breadcrumbs = [{"path":"/programming","deleted":false,"title":"Programmer Tips","dir":"ltr"},{"path":"/programming/shrinking-vm-disk-images","deleted":false,"title":"Shrinking VM Disk Images","dir":"ltr"}];
  var JOT_clearDotPath = 'http://www.gstatic.com/sites/p/25ccba/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"enableAnalytics":true,"pageSharingId":"jotspot_page","enableUniversalAnalytics":false,"sharingPolicy":"OPENED","siteTitle":"fidian.com","isStartPageEnabled":false,"adsensePublisherId":"ca-pub-4030324319031673","features":{"languageSelectDefaultTextSetToDefault":true,"moreMobileStyleImprovements":true,"accessibleSortingButtons":false,"driveImageLinkFromOnepick":true,"analyticsFullSamplingRate":true,"domainAnalyticsInGAOnly":true,"noCaptcha":true,"fileCabinetScreenReaderFix":true,"updatedTosAndPrivacyLinks":null,"pageDrafts":false,"mobileOrientationFix":true,"plusBadge":false,"pdfEmbedSupport":false,"jsClickFix":true},"isPublic":true,"isConsumer":true,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"onepickBaseUrl":"https://docs.google.com","domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://www.google.com/a/SelectSession?continue\u003dhttp://sites.google.com/site/minimifidianism/programming/shrinking-vm-disk-images\u0026service\u003djotspot","analyticsAccountId":"UA-23514641-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"http://csi.gstatic.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["http://www.gstatic.com/sites/p/25ccba/system/app/css/sitelayouteditor.css"],"text":["http://www.gstatic.com/sites/p/25ccba/system/js/codemirror.js","http://www.gstatic.com/sites/p/25ccba/system/app/css/codemirror_css.css","http://www.gstatic.com/sites/p/25ccba/system/js/trog_edit__en.js","http://www.gstatic.com/sites/p/25ccba/system/app/css/trogedit.css","/_/rsrc/1436776950000/system/app/css/editor.css","http://www.gstatic.com/sites/p/25ccba/system/app/css/codeeditor.css","/_/rsrc/1436776950000/system/app/css/camelot/editor-jfk.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"defaultdomain","baseUri":"","name":"minimifidianism","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/programming","parentWuid":"wuid:gx:331c4b2e063b4f3b","siteLocale":"en","timeZone":"America/Los_Angeles","type":"announcements","title":"Shrinking VM Disk Images","locale":"en","wuid":"wuid:gx:1c0313cedd3d850e","revision":9,"path":"/programming/shrinking-vm-disk-images","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"shrinking-vm-disk-images","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/announcements","title":"Announcements"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<link rel="canonical" href="shrinking-vm-disk-images.html" />
<meta name="google-site-verification" content="p1s03aetmagGLelXIzzsjl6h4gCAtRBHvmx9mxYBFqU" />
<meta name="title" content="Shrinking VM Disk Images - fidian.com" />
<meta itemprop="name" content="Shrinking VM Disk Images - fidian.com" />
<meta property="og:title" content="Shrinking VM Disk Images - fidian.com" />
<meta name="description" content="General advice and tips for programmers as well as documentation for open source projects." />
<meta itemprop="description" content="General advice and tips for programmers as well as documentation for open source projects." />
<meta id="meta-tag-description" property="og:description" content="General advice and tips for programmers as well as documentation for open source projects." />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="http://www.gstatic.com/sites/p/25ccba/system/app/themes/smoke/standard-css-smoke-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="../_/rsrc/1436776950000/system/app/css/overlay.css%3Fcb=smoke21a960px204goog-ws-leftnonethemedefaultstandard.css" />
<link rel="stylesheet" type="text/css" href="../_/rsrc/1436776950000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Shrinking VM Disk Images - fidian.com</title>
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><h2><a href="../index.html" dir="ltr" id="sites-chrome-userheader-title">fidian.com</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="http://www.fidian.com/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:204px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_2bd" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList" class="has-expander"><li class="topLevel nav-first "><div dir="ltr" style="padding-left: 19px;"><a href="../home.html" jotId="wuid:gx:1771d7481512b604" class="sites-navigation-link topLevel">Home</a></div></li><li class="topLevel parent " wuid="gx:34c65afb0d98f7c"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../announcements.html" jotId="wuid:gx:34c65afb0d98f7c" class="sites-navigation-link topLevel">Announcements</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../announcements/addinggitdocumentation.html" jotId="wuid:gx:3a62a773caa9ebc7" class="sites-navigation-link">Adding Git Documentation</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../announcements/cssbeautifier.html" jotId="wuid:gx:58a4534fe2322c5c" class="sites-navigation-link">CSS Beautifier</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../announcements/cssvalidationlibraryready.html" jotId="wuid:gx:6c6f10c9def0b3b7" class="sites-navigation-link">CSS Validation Library Ready</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../announcements/prettycss010andnewsection.html" jotId="wuid:gx:7d95f88de4417d93" class="sites-navigation-link">PrettyCSS 0.1.0 and New Section</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../announcements/prettycss020.html" jotId="wuid:gx:7945be096ca5a618" class="sites-navigation-link">PrettyCSS 0.2.0</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../announcements/prettycss030.html" jotId="wuid:gx:780d41c09a921321" class="sites-navigation-link">PrettyCSS 0.3.0</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../announcements/prettycss033.html" jotId="wuid:gx:34b9941c75297d6b" class="sites-navigation-link">PrettyCSS 0.3.3</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../announcements/prettycssworks.html" jotId="wuid:gx:63633aefa855a2d9" class="sites-navigation-link">PrettyCSS Works</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../announcements/site-launch.html" jotId="wuid:gx:237844d58f5d86ad" class="sites-navigation-link">Site Launch!</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../announcements/writingtestsforprettycss.html" jotId="wuid:gx:24aee998dfca4145" class="sites-navigation-link">Writing Tests for PrettyCSS</a></div></li></ul></li><li class="topLevel "><div dir="ltr" style="padding-left: 19px;"><a href="../contact.html" jotId="wuid:gx:75b0c67f6ceff965" class="sites-navigation-link topLevel">Contact</a></div></li><li class="topLevel parent " wuid="gx:35c56cb9fa6e9467"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../git.html" jotId="wuid:gx:35c56cb9fa6e9467" class="sites-navigation-link topLevel">Git</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../git/advice.html" jotId="wuid:gx:6facb6794db9b01a" class="sites-navigation-link">Advice (Please Read)</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../git/aliases.html" jotId="wuid:gx:7799140dabba497a" class="sites-navigation-link">Aliases</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../git/configuring-git.html" jotId="wuid:gx:3debde115ba76e5f" class="sites-navigation-link">Configuring Git</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../git/external-resources.html" jotId="wuid:gx:729186974b869b93" class="sites-navigation-link">External Resources</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../git/git-tricks.html" jotId="wuid:gx:3e68af1f7df2a42" class="sites-navigation-link">Git Tricks</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../git/quick-reference.html" jotId="wuid:gx:5c264c0f002f81c6" class="sites-navigation-link">Quick Reference</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../git/start-a-repository.html" jotId="wuid:gx:221acfa88160d460" class="sites-navigation-link">Start a Repository</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../git/submodules.html" jotId="wuid:gx:5a5ddad6374efc53" class="sites-navigation-link">Submodules</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../git/terminology.html" jotId="wuid:gx:7935266caa088f34" class="sites-navigation-link">Terminology</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../git/typical-usage.html" jotId="wuid:gx:77c113f067ae061e" class="sites-navigation-link">Typical Usage</a></div></li></ul></li><li class="topLevel parent " wuid="gx:38e149882efee685"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../phptools.html" jotId="wuid:gx:38e149882efee685" class="sites-navigation-link topLevel">PHPTools</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../phptools/db.html" jotId="wuid:gx:41575224e7dd52bc" class="sites-navigation-link">DB</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../phptools/dependencyinjectioncontainer.html" jotId="wuid:gx:7d698e02481eaa0d" class="sites-navigation-link">DependencyInjectionContainer</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../phptools/logger.html" jotId="wuid:gx:503a668638fde00b" class="sites-navigation-link">Logger</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../phptools/tokenizer.html" jotId="wuid:gx:5401932fce87a338" class="sites-navigation-link">Tokenizer</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../phptools/webrequest.html" jotId="wuid:gx:7ab5fd9a2d3ebc74" class="sites-navigation-link">WebRequest</a></div></li></ul></li><li class="topLevel parent " wuid="gx:6c524a81620ec71e"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../prettycss.html" jotId="wuid:gx:6c524a81620ec71e" class="sites-navigation-link topLevel">PrettyCSS</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../prettycss/command-line.html" jotId="wuid:gx:6944bfbd530dfddd" class="sites-navigation-link">Command Line</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../prettycss/download.html" jotId="wuid:gx:7bb0805a5a465904" class="sites-navigation-link">Download</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../prettycss/error-warning-codes.html" jotId="wuid:gx:129ec4d0ad6810c9" class="sites-navigation-link">Error/Warning Codes</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../prettycss/installation.html" jotId="wuid:gx:3adf4194fd77628" class="sites-navigation-link">Installation</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../prettycss/lint-checking.html" jotId="wuid:gx:c3913bcb09880bf" class="sites-navigation-link">Lint Checking</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../prettycss/object-methods.html" jotId="wuid:gx:2aa8748a78f21a6d" class="sites-navigation-link">Object Methods</a></div></li></ul></li><li class="topLevel parent " wuid="gx:17cff23338bfc277"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../problems-only-tyler-has.html" jotId="wuid:gx:17cff23338bfc277" class="sites-navigation-link topLevel">Problems Only Tyler Has</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../problems-only-tyler-has/backupsandrecovery.html" jotId="wuid:gx:2edab9b61e30087" class="sites-navigation-link">Backups and Recovery</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../problems-only-tyler-has/chefupgradeissue.html" jotId="wuid:gx:4b85f76c7821da14" class="sites-navigation-link">Chef Upgrade Issue</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../problems-only-tyler-has/diablo3onubuntulinux.html" jotId="wuid:gx:575e0fd8f752803e" class="sites-navigation-link">Diablo 3 on Ubuntu Linux</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../problems-only-tyler-has/disabling-hyperthreading.html" jotId="wuid:gx:5bf84cf0361dff4a" class="sites-navigation-link">Disabling Hyperthreading</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../problems-only-tyler-has/ie8divheightchanging.html" jotId="wuid:gx:20e3cbaf1c9309e5" class="sites-navigation-link">IE8 &lt;div&gt; Height Changing</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../problems-only-tyler-has/opscode-chef-rabbitmq.html" jotId="wuid:gx:2952adae0b8c6ee6" class="sites-navigation-link">Opscode Chef + RabbitMQ</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../problems-only-tyler-has/renaming-windows-network-adapter.html" jotId="wuid:gx:5442ce3c86376e1d" class="sites-navigation-link">Renaming Windows Network Adapter for VirtualBox</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../problems-only-tyler-has/using-grant-all-with-amazons-mysql-rds.html" jotId="wuid:gx:2cfe84f463d553b4" class="sites-navigation-link">Using "GRANT ALL" With Amazon's MySQL RDS</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../problems-only-tyler-has/wcfandgzipcompression.html" jotId="wuid:gx:1d18cb4a2f2398e8" class="sites-navigation-link">WCF and gzip compression</a></div></li></ul></li><li class="topLevel parent " wuid="gx:331c4b2e063b4f3b"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../programming.html" jotId="wuid:gx:331c4b2e063b4f3b" class="sites-navigation-link topLevel">Programmer Tips</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="best-programming-language.html" jotId="wuid:gx:61be19448aabbcf" class="sites-navigation-link">Best Programming Language?</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="escaping-strings.html" jotId="wuid:gx:52f20c9863e4d870" class="sites-navigation-link">Escaping Strings</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="parameterorder.html" jotId="wuid:gx:3120b522ce37b4b7" class="sites-navigation-link">Parameter Order</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="passwordsecurity.html" jotId="wuid:gx:66ec5f635533e9bc" class="sites-navigation-link">Password Security</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="public-dns-pointing-to-localhost.html" jotId="wuid:gx:473ab3e46f634bc9" class="sites-navigation-link">Public DNS Pointing To localhost (127.0.0.1)</a></div></li><li class=""><div class="current-bg" jotId="wuid:gx:1c0313cedd3d850e" dir="ltr" style="padding-left: 38px;">Shrinking VM Disk Images</div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="vmware-tweaks.html" jotId="wuid:gx:2d96bd29d2adbd6d" class="sites-navigation-link">VMWare Tweaks</a></div></li></ul></li><li class="topLevel "><div dir="ltr" style="padding-left: 19px;"><a href="../system/app/pages/sitemap/hierarchy.html" jotId="wuid:gx:7322dda012fd51b3" class="sites-navigation-link topLevel">Sitemap</a></div></li><li class="topLevel "><div dir="ltr" style="padding-left: 19px;"><a href="../system/app/pages/recentChanges.html" jotId="wuid:gx:6ceaefc82a6a664d" class="sites-navigation-link topLevel">Recent site activity</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_2120934089180082" class="sites-sidebar-plusone-wrapper"><div class="g-plusone" data-count="true" data-size="standard" data-source="google:sites"></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="../programming.html" dir="ltr">Programmer Tips</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Shrinking VM Disk Images</span>
</h3>
<span class="announcementsPostTimestamp" id="afterPageTitleHideDuringEdit">
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      //<![CDATA[
        function JOT_insertRelDate(timestamp, absTimeStr, isSiteLocale, dir) {
          var relTimeStr = JOT_formatRelativeToNow(timestamp, isSiteLocale);
          if (relTimeStr) {
            if (isSiteLocale) {
              document.write('<span timestamp="' + timestamp + '" issitelocale="' + isSiteLocale +
                '" title="' + absTimeStr + '" dir="' + dir + '">' + relTimeStr + '<' + '/span>');
            } else {
              document.write('<span timestamp="' + timestamp + '" title="' + absTimeStr +
              '" dir="' + dir + '">' + relTimeStr + '<' + '/span>');
            }
          } else {
            document.write(absTimeStr);
          }
        }
      //]]>
</script>
      
    
  
  posted <span xmlns="http://www.w3.org/1999/xhtml" dir="ltr">Jan 12, 2012, 3:19 PM</span> by Tyler Akins

                  
                       
                      <span id="sites-announcement-updated-time" class="updatedTime">
                        [
  
  
  
  
  updated <span xmlns="http://www.w3.org/1999/xhtml" dir="ltr">Jun 8, 2012, 10:28 AM</span>
]
                      </span>
</span>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr">I have been asked to compress dynamically-sized virtual disk images more than once.  These instructions can apply to VMDK files (common for VMWare) and VMI files (VirtualBox).  This sort of request seems to come up every year or two for me.  Usually it is because some place is gearing up to distribute these disk images and serving up gigs of data is undesirable.<br /><br />
I come up with the same sort of steps time and time again.  Instead of recreating this work for the next time I get asked, I'm posting these instructions online to record them publicly.  I've found that they are more thorough than what I find on other sites, so perhaps you could benefit from these instructions too.<br />
<h2><a name="TOC-First-Step---Backup"></a>First Step - Backup</h2>
Make a backup.  The steps below can really destroy images; follow them AT YOUR OWN RISK.<br />
<h2><a name="TOC-Reconfigure-The-Machine"></a>Reconfigure The Machine</h2>
Before you distribute the disk image around, you may need to tweak the configuration so that other virtualization tools will work with your image correctly.<br />
<h3><a name="TOC-Disable-Network-Configs-Via-MAC-Addresses"></a>Disable Network Configs Via MAC Addresses</h3>
If you use kudzu, you should disable it or it may prompt you when you start up the VM and it has a new MAC address.  Kudzu ships with older Red Hat and CentOS.<br /><br />
<div class="sites-codeblock sites-codesnippet-block"><code>chkconfig kudzu off</code></div><div><br /></div>
Newer systems use udev.  You can disable the persistent network connections with these commands.<br /><br />
<div class="sites-codeblock sites-codesnippet-block"><code>rm /etc/udev/rules.d/70-persistent-net.rules<br />
cd /lib/udev/rules.d<br />
rm 75-persistent-net-generator.rules &amp;&amp; touch 75-persistent-net-generator.rules<br />
</code></div><div><br /></div>
You will also need to make sure you networking scripts don't have hardcoded HWADDR lines.<br /><br />
<div class="sites-codeblock sites-codesnippet-block"><code>cd /etc/sysconfig/network-scripts</code><br />
<code>perl -pi -e "s/^HWADDR/#HWADDR/" ifcfg-eth*</code></div>
<h2><a name="TOC-Free-More-Space"></a>Free More Space</h2>
It is a common misconception that deleting files on your dynamically sized disk image will make the disk image shrink.  This is not true - the virtual machine software doesn't peek into the filesystem to determine that sectors aren't needed any longer.  More on this later ...  For now, let's focus on making some room.<br /><br />
Delete temp files.  They shouldn't be needed.<br /><br />
<div class="sites-codeblock sites-codesnippet-block"><code># Linux variants<br />
find /tmp /var/tmp -mindepth 1 -maxdepth 1 -exec rm -rf \{\}</code></div><div><br /></div>
If you are on Windows, you can usually delete the files in C:\Windows\Temp or use a program like <a href="http://www.piriform.com/ccleaner">CCleaner</a> to thoroughly scrub away temporary files and unused garbage.<br /><br />
Clean your package manager's cache on Linux:<br /><br />
<div class="sites-codeblock sites-codesnippet-block"><code># Red Hat, CentOS</code><br />
<code>yum clean all<br />
<br />
# Debian, Ubuntu<br />
apt-get clean<br />
apt-get autoclean<br />
</code></div><div><br /></div>
Also, you could clean out logs in /var/log.  This section could be improved - just let me know other things that could be cleaned out.<br /><br />
<h3><a name="TOC-Defragment-The-Drive"></a>Defragment The Drive</h3>
This step really isn't needed, but it could help to squeeze out a few more bytes if you are really concerned.  There's really no defrag for Linux.  For Windows, I suggest using <a href="http://ultradefrag.sourceforge.net/">UltraDefrag</a>.<br />
<h2><a name="TOC-Wiping-Free-Space"></a>Wiping Free Space</h2>
Even after you delete the files, the hard drive image still has the contents of the old file on it.  This is why programs like <a href="http://www.cgsecurity.org/wiki/PhotoRec">photorec</a> can work.  We need to wipe the data clean off the drive by writing NULL (hex 0x00) bytes to all of the free areas on the drive.  This still doesn't make the image any smaller.  More on this later ...<br />
<h3><a name="TOC-Wiping-Linux-From-CD"></a>Wiping Linux From CD<br />
</h3>
The easiest way to wipe extfs filesystems (ext2, ext3, ext4) is with <a href="../index.html">zerofree</a>.  It's the faster choice.  You can download the iso image of <a href="http://partedmagic.com/">Parted Magic</a> and configure your VM to mount that as a virtual CD-ROM.  Boot from it, then open a terminal by clicking on the black monitor icon at the bottom.  From there, it is a few simple commands:<br /><br />
<div class="sites-codeblock sites-codesnippet-block"><code># Wipe a hard drive partition.  Let's say that /dev/sda1 is for /boot and /dev/sda2 is /root</code><br />
<code>zerofree -v /dev/sda1</code><br />
<code>zerofree -v /dev/sda2</code><br />
<br />
<code># Do you use LVM?  Don't forget that your device name may differ from mine.</code><br />
<code># If you are unsure which device, look in /dev/mapper</code><br />
<code>vgchange -a y</code><br />
<code>zerofree -v /dev/mapper/VolGroup00_LogVol00</code></div><div><br /></div>
Now we can also wipe the swap.<br /><br />
<div class="sites-codeblock sites-codesnippet-block"><code># If swap is a normal partition ... make sure you know which partition it is!</code><br />
<code># You can also use ddrescue or dd_rescue instead</code><br />
<code>dd if=/dev/zero of=/dev/</code><code>sda3</code><code> bs=1M</code><br />
<br />
<code># If you use LVM, the device will be under /dev/mapper instead</code><br />
<code>dd if</code><code>=/dev/zero of=/dev/mapper/</code><code> bs=1M</code></div><div><br /></div>
Guarantee we're done and shut down.<br /><br />
<div class="sites-codeblock sites-codesnippet-block"><code>sync</code><br />
<code>shudown -h now</code></div>
<h3><a name="TOC-Wiping-Linux-From-Itself"></a>Wiping Linux From Itself</h3>
You can also use zerofree on the system if you prevent things from writing to the disk.  This is a bit more risky.<br /><br />
<div class="sites-codeblock sites-codesnippet-block">
<code># Shut down to single user mode</code><br />
<code>init 1</code><br />
<br />
<code># Remount the drive read only</code><br />
<code># If you get errors, use "fuser -m /" to see process IDs that have open files</code><br />
<code># Once they get killed or handled, then try this command again</code><br />
<code>mount -o remount,ro /</code><br />
<br /><br />
<code># Start wiping, assuming that the drive mounted to / is /dev/sda2</code><br />
<code>zerofree -v /dev/sda2</code><br />
<br />
<code># Wipe the boot partition, assuming you have one and it is /dev/sda1</code><br />
<code>zerofree -v /dev/sda1</code><br />
<br />
<code># Clear the swap space</code><code>, assuming it is /dev/sda4</code><br />
<code>swapoff</code><br />
<code>dd if=/dev/zero of=/dev/sda4 bs=1M</code><br />
<code>mkswap /dev/sda4</code><br />
<br />
<code># Guarantee we did things</code><br />
<code>sync</code><br />
<br />
<code># Done.  Shut down the machine now!</code><br />
<code>shutdown -h now</code><br />
</div>
<h3><a name="TOC-Wiping-Windows-From-Itself"></a>Wiping Windows From Itself</h3>
There are a couple tools that I'd recommend.  First, <a href="http://www.piriform.com/ccleaner">CCleaner</a> has added a built-in disk wiping utility.  It's easy to use.  Alternately, <a href="http://www.heidi.ie/eraser/">Eraser</a> also is a nice tool with a GUI.  If command-line tools are more your thing, check out  <a href="http://technet.microsoft.com/en-us/sysinternals/bb897443">SDelete</a> from Microsoft's site, then open a command prompt and run it.<br /><br />
<div class="sites-codeblock sites-codesnippet-block"><code>sdelete /c c</code></div>
<h3><a name="TOC-Wiping-Linux-By-Filling-The-Disk"></a>Wiping Linux By Filling The Disk</h3>
As a last resort, you can use "dd" to fill a disk.  I suggest you boot from a bootable CD image, mount your filesystem, then run dd.  That way you can prevent many bad things from happening.  Either way, you'd be executing commands such as this<br /><br />
<div class="sites-codeblock sites-codesnippet-block"><code>cd /mount_point_I_want_to_fill</code><br />
<code>dd if=/dev/null of=empty_file</code><br />
<code>rm empty_file</code></div>
<h3><a name="TOC-Wiping-Windows-By-Filling-The-Disk"></a>Wiping Windows By Filling The Disk</h3>
It is better to not fill your hard drive with a big empty file, but these instructions are provided in case you really don't have a better way.<br /><br />
You can use nullfile to create this huge, empty file; <a href="http://www.feyrer.de/g4u/">Harddisk Image Cloning for PCs</a> has links to the software.  I'd suggest using Control-F to find "nullfile" instead of scrolling.  All you need to do is double-click to run it.<br /><br />
There is also a <a href="http://www.chrysocome.net/dd">Windows port of dd</a> that works very similarly to the Unix version.  Open a command prompt and run these commands to fill your disk<br /><br />
<div class="sites-codeblock sites-codesnippet-block"><code>dd if=/dev/zero of=empty_file bs=1M</code><br />
<code>del empty_file</code></div>
<h2><a name="TOC-Resizing-The-Disk-Image"></a>Resizing The Disk Image</h2>
Finally, after we freed up lots of space and wiped the space with zeros, we can now shrink the image.  The virtualization software would have too big of a burden to resize the disk image on the fly to get smaller.  Maybe it can be smart and do this in the background someday, but for now we are forced to manually resize the file ourselves.  Here's all of the solutions I know about.  I haven't had any need to start VMs on Linux or MacOS, but the instructions below should be similar to your install.<br />
<h3><a name="TOC-VMWare-Server-s-Utility---Windows-Host"></a>VMWare Server's Utility - Windows Host</h3>
VMWare Server comes with vmware-vdiskmanager, which can shrink .vmdk files.  Open up a command prompt and run vmware-vdiskmanager.<br />
<br />
<div class="sites-codeblock sites-codesnippet-block"><code>"C:\Program Files\VMware\VMWare Server\vmware-vdiskmanager" -k my_disk_image.vmdk</code><br /></div><br /><h3><a name="TOC-VMWare-Player---Windows-Host"></a>
VMWare Player - Windows Host</h3>
Open up VMWare Player and edit the virtual machine.  Select the hard disk, then there's a button on the right that says Utilities.  Under that drop-down menu is an option, "Compact".  Presto-chango, you are done.<br />
<h3><a name="TOC-VirtualBox---Windows-Host"></a>VirtualBox - Windows Host<br />
</h3>
The VBoxManage command can use "modifyhd" to shrink .vdi files but there is no support for shrinking .vmdk files, which VirtualBox can also read and write.<br /><br />
<div class="sites-codeblock sites-codesnippet-block"><code>"C:\Program Files\Oracle\VirtualBox\VBoxManage" modifyhd my_disk_image.vdi --compact</code><br /></div><br />
Alternately you can copy the disk to a new image, but this changes the UUID.  By changing the format parameter, you can change it to a VMDK file or other types.  When you do this, you'll need to go to VirtualBox and remove the old disk image and attach the new one, then you can finally delete the big disk image.<br /><br />
<div class="sites-codeblock sites-codesnippet-block"><code>"C:\Program Files\Oracle\VirtualBox\VBoxManage" clonehd my_disk_image.vdi my_shrunken_image.vdi --format VDI</code><br /></div><br />
<h3><a name="TOC-Vagrant"></a>Vagrant</h3>
When Vagrant makes a new package, it will automatically clone the hard drive, which uses the virtualization software's process for copying a hard drive.  This won't copy the blank sections of the disk, making a smaller image automatically.<br />
<h1><a name="BuildingaVagrantBoxforRedistribution-WipingFreeSpace"></a></h1></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div id="sites-attachments-container">
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=http://sites.google.com/site/minimifidianism/programming/shrinking-vm-disk-images">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="../system/app/pages/recentChanges.html">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="../system/app/pages/reportAbuse.html" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="http://www.gstatic.com/sites/p/25ccba/system/js/jot_min_announcements_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                JOT_postEvent('moduleLoad');
              </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
      
          sites.core.Analytics.createTracker();
          sites.core.Analytics.trackPageview();
        
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("2bd", "Navigation", true);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_2bd');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXvcOPJbPRyitr27PJuqbPG4ctilRfZfgUDyHWcu-m7kNz7Yedg-dkOgs5Q7t_bMDD9StHAboNa8YfpDPo88vh-HMvxKwrTOZZTBvj8ge3jFwAygRkmXIL8Orp0rmZT8-oWtbne3/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([]);
    gsites.Xhr.send('http://www.fidian.com/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'http://csi.gstatic.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
